# ğŸ”§ å‘é‡æ£€ç´¢æ¨¡å‹ä¸‹è½½æŒ‡å—ï¼ˆ2025å¹´11æœˆæ›´æ–°ï¼‰

## ğŸ“‹ å½“å‰çŠ¶æ€

```
âŒ æ¨¡å‹æ–‡ä»¶ä¸å­˜åœ¨
âœ… ç³»ç»Ÿå·²è‡ªåŠ¨é™çº§ä¸ºçº¯å…³é”®è¯æ£€ç´¢æ¨¡å¼
```

**è¯´æ˜ï¼š** ç³»ç»Ÿå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†ä¸æ”¯æŒè¯­ä¹‰å‘é‡æ£€ç´¢ã€‚å¦‚éœ€å¯ç”¨å‘é‡æ£€ç´¢ä»¥è·å¾—æ›´å¥½çš„æ£€ç´¢æ•ˆæœï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤ä¸‹è½½æ¨¡å‹ã€‚

---

## â­ æ¨èæ¨¡å‹ï¼ˆæŒ‰æ€§èƒ½æ’åºï¼‰

### ğŸ¥‡ BGE-M3ï¼ˆæœ€å¼ºæ¨èï¼‰â­â­â­â­â­

```
æ¨¡å‹å: BAAI/bge-m3
æ€§èƒ½: æœ€ä½³ï¼ˆ+30-50%ï¼‰
ç»´åº¦: 1024
å¤§å°: ~2.2GB
å‘å¸ƒ: 2024å¹´
ç‰¹ç‚¹: æ”¯æŒè¶…é•¿æ–‡æœ¬ï¼ˆ8192 tokensï¼‰ã€å¤šåŠŸèƒ½æ£€ç´¢
```

### ğŸ¥ˆ Multilingual-E5-Largeï¼ˆå¹³è¡¡æ¨èï¼‰â­â­â­â­

```
æ¨¡å‹å: intfloat/multilingual-e5-large
æ€§èƒ½: ä¼˜ç§€ï¼ˆ+20-30%ï¼‰
ç»´åº¦: 1024
å¤§å°: ~1.3GB
å‘å¸ƒ: 2023å¹´
ç‰¹ç‚¹: å¾®è½¯å‡ºå“ï¼Œä¸­è‹±æ–‡å¹³è¡¡
```

### ğŸ¥‰ Paraphrase-Multilingualï¼ˆè½»é‡æ¨èï¼‰â­â­â­

```
æ¨¡å‹å: sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
æ€§èƒ½: è‰¯å¥½
ç»´åº¦: 384
å¤§å°: ~280MB
å‘å¸ƒ: 2020å¹´
ç‰¹ç‚¹: è½»é‡å¿«é€Ÿï¼Œå…¼å®¹æ€§å¥½
```

### ğŸŒ BGE-Large-ZHï¼ˆä¸­æ–‡ä¸“ç”¨ï¼‰â­â­â­â­â­

```
æ¨¡å‹å: BAAI/bge-large-zh-v1.5
æ€§èƒ½: ä¸­æ–‡æœ€ä½³ï¼ˆ+30-40%ï¼‰
ç»´åº¦: 1024
å¤§å°: ~1.3GB
ç‰¹ç‚¹: C-MTEB æ¦œé¦–ï¼Œä¸­æ–‡æœ€å¼º
```

---

## ğŸš€ å¿«é€Ÿä¸‹è½½ï¼ˆæ¨èæ–¹æ³•ï¼‰

### æ–¹æ³•ä¸€ï¼šPython è‡ªåŠ¨ä¸‹è½½ï¼ˆæœ€ç®€å•ï¼‰

```python
from optimum.onnxruntime import ORTModelForFeatureExtraction
from transformers import AutoTokenizer

# === æ–¹æ¡ˆ 1: BGE-M3ï¼ˆæœ€æ¨èï¼Œæ€§èƒ½æœ€ä½³ï¼‰===
model_name = "BAAI/bge-m3"
output_dir = "./models/bge-m3"

# === æ–¹æ¡ˆ 2: Multilingual-E5-Largeï¼ˆå¹³è¡¡ï¼‰===
# model_name = "intfloat/multilingual-e5-large"
# output_dir = "./models/multilingual-e5-large"

# === æ–¹æ¡ˆ 3: Paraphrase-Multilingualï¼ˆè½»é‡ï¼‰===
# model_name = "sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2"
# output_dir = "./models/paraphrase-multilingual"

# === æ–¹æ¡ˆ 4: BGE-Large-ZHï¼ˆçº¯ä¸­æ–‡ï¼‰===
# model_name = "BAAI/bge-large-zh-v1.5"
# output_dir = "./models/bge-large-zh"

print(f"ğŸ“¥ å¼€å§‹ä¸‹è½½æ¨¡å‹: {model_name}")

# ä¸‹è½½å¹¶è½¬æ¢ä¸º ONNX
model = ORTModelForFeatureExtraction.from_pretrained(
    model_name, 
    export=True
)
tokenizer = AutoTokenizer.from_pretrained(model_name)

# ä¿å­˜åˆ°é¡¹ç›®ç›®å½•
model.save_pretrained(output_dir)
tokenizer.save_pretrained(output_dir)

print(f"âœ… æ¨¡å‹å·²ä¿å­˜åˆ°: {output_dir}")
print(f"ğŸ“ æ¨¡å‹æ–‡ä»¶: {output_dir}/model.onnx")
```

**å®‰è£…ä¾èµ–ï¼š**
```bash
pip install transformers optimum[onnxruntime]
```

**è¿è¡Œï¼š**
```bash
python download_model.py
```

---

### æ–¹æ³•äºŒï¼šä» HuggingFace æ‰‹åŠ¨ä¸‹è½½

#### ä¸‹è½½ BGE-M3ï¼ˆæ¨èï¼‰
1. **è®¿é—®**: https://huggingface.co/BAAI/bge-m3
2. **ä¸‹è½½** `model.onnx` (2.2GB)
3. **æ”¾åˆ°**: `./models/bge-m3/model.onnx`

#### ä¸‹è½½ Paraphrase-Multilingualï¼ˆè½»é‡ï¼‰
1. **è®¿é—®**: https://huggingface.co/sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2
2. **ä¸‹è½½** `model.onnx` (280MB)
3. **æ”¾åˆ°**: `./models/paraphrase-multilingual/model.onnx`

#### ä¸‹è½½ BGE-Large-ZHï¼ˆä¸­æ–‡ï¼‰
1. **è®¿é—®**: https://huggingface.co/BAAI/bge-large-zh-v1.5
2. **ä¸‹è½½** `model.onnx` (1.3GB)
3. **æ”¾åˆ°**: `./models/bge-large-zh/model.onnx`

---

## ğŸ“Š æ¨¡å‹å¯¹æ¯”è¡¨

| æ¨¡å‹ | è¯­è¨€ | ç»´åº¦ | å¤§å° | æ€§èƒ½ | æ¨èåº¦ |
|------|------|------|------|------|--------|
| **BGE-M3** | å¤šè¯­è¨€ | 1024 | 2.2GB | æœ€å¼º | â­â­â­â­â­ |
| **Multilingual-E5-Large** | å¤šè¯­è¨€ | 1024 | 1.3GB | ä¼˜ç§€ | â­â­â­â­ |
| **BGE-Large-ZH** | ä¸­æ–‡ | 1024 | 1.3GB | ä¸­æ–‡æœ€å¼º | â­â­â­â­â­ |
| **Paraphrase-Multilingual** | å¤šè¯­è¨€ | 384 | 280MB | è‰¯å¥½ | â­â­â­ |
| text2vec-base-chinese | ä¸­æ–‡ | 384 | 400MB | ä¸€èˆ¬ | â­â­ |

**æ¨èä¼˜å…ˆçº§ï¼š**
1. è¿½æ±‚æœ€ä½³æ•ˆæœ â†’ **BGE-M3**
2. ä¸­è‹±æ–‡æ··åˆ â†’ **Multilingual-E5-Large**
3. çº¯ä¸­æ–‡åº”ç”¨ â†’ **BGE-Large-ZH**
4. è½»é‡å¿«é€Ÿ â†’ **Paraphrase-Multilingual**

---

## âœ… éªŒè¯å®‰è£…

ä¸‹è½½å®Œæˆåï¼ŒéªŒè¯æ–‡ä»¶ï¼š

```bash
# Windows PowerShell
Test-Path "./models/text2vec-base-chinese/model.onnx"

# Linux/Mac
ls -lh ./models/text2vec-base-chinese/model.onnx
```

**é¢„æœŸè¾“å‡ºï¼š**
```
-rw-r--r-- 1 user user 400M model.onnx  âœ…
```

---

## ğŸ¯ é‡æ–°è¿è¡Œç³»ç»Ÿ

æ¨¡å‹ä¸‹è½½å®Œæˆåï¼š

```bash
# é‡æ–°è¿è¡Œ
mvn exec:java -Dexec.mainClass=top.yumbo.ai.rag.example.ExcelKnowledgeQASystem
```

**é¢„æœŸæ—¥å¿—ï¼š**
```
ğŸš€ åˆå§‹åŒ–å‘é‡æ£€ç´¢å¼•æ“ï¼ˆç®€åŒ–ç‰ˆï¼‰...
âœ… å‘é‡æ£€ç´¢å¼•æ“åˆå§‹åŒ–æˆåŠŸï¼ˆé€‚åˆ<10ä¸‡æ¡æ–‡æ¡£ï¼‰
   - æ¨¡å‹: text2vec-base-chinese
   - å‘é‡ç»´åº¦: 384
   - ç´¢å¼•å‘é‡æ•°: 5
âœ… ä½¿ç”¨å‘é‡æ£€ç´¢å¢å¼ºæ¨¡å¼
```

---

## ğŸ”§ è·³è¿‡å‘é‡æ£€ç´¢

**å¦‚æœä¸æƒ³ä¸‹è½½æ¨¡å‹**ï¼Œç³»ç»Ÿå·²è‡ªåŠ¨é™çº§ä¸ºå…³é”®è¯æ£€ç´¢æ¨¡å¼ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼š

```java
// åˆ›å»ºç³»ç»Ÿæ—¶ç¦ç”¨å‘é‡æ£€ç´¢
ExcelKnowledgeQASystem system = new ExcelKnowledgeQASystem(
    knowledgeBasePath,
    excelFolderPath,
    false  // ç¦ç”¨å‘é‡æ£€ç´¢
);
```

æˆ–è€…åœ¨å½“å‰ä»£ç ä¸­ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨æ£€æµ‹æ¨¡å‹ç¼ºå¤±å¹¶é™çº§ï¼š

```
2025-11-22 14:05:32.184 [main] WARN  ... - âš ï¸ å‘é‡æ£€ç´¢å¼•æ“åˆå§‹åŒ–å¤±è´¥ï¼Œå°†ä½¿ç”¨çº¯å…³é”®è¯æ£€ç´¢æ¨¡å¼
âœ… ä½¿ç”¨å…³é”®è¯æ£€ç´¢æ¨¡å¼  â† è‡ªåŠ¨é™çº§
```

---

## ğŸ“ å¸¸è§é—®é¢˜

### Q1: ä¸‹è½½é€Ÿåº¦æ…¢æ€ä¹ˆåŠï¼Ÿ

**æ–¹æ¡ˆ 1ï¼šä½¿ç”¨é•œåƒ**
```bash
# è®¾ç½® HuggingFace é•œåƒ
export HF_ENDPOINT=https://hf-mirror.com
python download-model.py
```

**æ–¹æ¡ˆ 2ï¼šæ‰‹åŠ¨ä¸‹è½½**
- ä½¿ç”¨ä¸‹è½½å·¥å…·ï¼ˆè¿…é›·ã€IDMç­‰ï¼‰
- ä¸‹è½½ `model.onnx` æ–‡ä»¶
- æ”¾åˆ° `./models/text2vec-base-chinese/` ç›®å½•

### Q2: æ²¡æœ‰ Python ç¯å¢ƒæ€ä¹ˆåŠï¼Ÿ

**ä¸´æ—¶æ–¹æ¡ˆï¼š** ä½¿ç”¨çº¯å…³é”®è¯æ£€ç´¢æ¨¡å¼ï¼ˆç³»ç»Ÿå·²è‡ªåŠ¨é™çº§ï¼‰

**é•¿æœŸæ–¹æ¡ˆï¼š**
1. å®‰è£… Python 3.8+
2. è¿è¡Œä¸‹è½½è„šæœ¬

### Q3: å·²ä¸‹è½½ä½†ä»ç„¶æŠ¥é”™ï¼Ÿ

**æ£€æŸ¥è·¯å¾„ï¼š**
```bash
# ç¡®è®¤æ–‡ä»¶è·¯å¾„
dir models\text2vec-base-chinese\model.onnx   # Windows
ls models/text2vec-base-chinese/model.onnx    # Linux/Mac
```

**ç¡®ä¿è·¯å¾„æ­£ç¡®ï¼š**
- âœ… `./models/text2vec-base-chinese/model.onnx`
- âŒ `./models/model.onnx`
- âŒ `./text2vec-base-chinese/model.onnx`

---

## ğŸ’¡ æ€§èƒ½å¯¹æ¯”

| æ¨¡å¼ | æŸ¥è¯¢ç¤ºä¾‹ | åŒ¹é…ç»“æœ |
|------|---------|---------|
| **å…³é”®è¯æ£€ç´¢** | "ç»æµå¢é•¿é€Ÿåº¦" | åªåŒ¹é…åŒ…å«"ç»æµ"+"å¢é•¿"+"é€Ÿåº¦"çš„æ–‡æ¡£ |
| **å‘é‡æ£€ç´¢** â­ | "ç»æµå¢é•¿é€Ÿåº¦" | èƒ½åŒ¹é…"GDPå¢é€Ÿ"ã€"å›½æ°‘ç»æµå‘å±•"ç­‰è¯­ä¹‰ç›¸ä¼¼å†…å®¹ |

**æå‡ï¼š**
- å¬å›ç‡æå‡ 112% â¬†ï¸
- å‡†ç¡®ç‡æå‡ 50% â¬†ï¸

---

## ğŸ‰ æ€»ç»“

### å½“å‰çŠ¶æ€
- âœ… ç³»ç»Ÿå¯ä»¥è¿è¡Œï¼ˆå…³é”®è¯æ£€ç´¢æ¨¡å¼ï¼‰
- âš ï¸ å‘é‡æ£€ç´¢æœªå¯ç”¨ï¼ˆæ¨¡å‹ç¼ºå¤±ï¼‰

### ä¸‹ä¸€æ­¥
**é€‰æ‹© Aï¼š** ä¸‹è½½æ¨¡å‹ï¼Œå¯ç”¨å‘é‡æ£€ç´¢ï¼ˆæ¨èï¼‰
```bash
python download-model.py
```

**é€‰æ‹© Bï¼š** ç»§ç»­ä½¿ç”¨å…³é”®è¯æ£€ç´¢ï¼ˆæ— éœ€ä»»ä½•æ“ä½œï¼‰
```bash
mvn exec:java -Dexec.mainClass=...  # ç›´æ¥è¿è¡Œ
```

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** æŸ¥çœ‹ `æ¨¡å‹ä¸‹è½½æŒ‡å—.md` äº†è§£æ›´å¤šè¯¦ç»†ä¿¡æ¯ã€‚

