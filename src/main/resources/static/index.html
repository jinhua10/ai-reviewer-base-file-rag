<!DOCTYPE html>
<html lang="zh-CN" id="html-root">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Áü•ËØÜÂ∫ìÈóÆÁ≠îÁ≥ªÁªü - Knowledge Base QA System</title>

    <!-- React Âíå ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>

    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Axios for API calls -->
    <script src="https://unpkg.com/axios/dist/axios.min.js"></script>

    <!-- Marked.js for Markdown rendering -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Highlight.js for code syntax highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>

    <!-- Ant Design CSS -->
    <link rel="stylesheet" href="https://unpkg.com/antd@5/dist/reset.css" />

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        #root {
            padding: 20px;
        }

        .app-container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .main-content {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            padding: 30px;
            margin-bottom: 20px;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid #f0f0f0;
        }

        .tab {
            padding: 12px 24px;
            border: none;
            background: none;
            cursor: pointer;
            font-size: 16px;
            color: #666;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tab:hover {
            color: #667eea;
        }

        .tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            font-weight: 600;
        }

        .tab-content {
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .qa-section {
            margin-bottom: 30px;
        }

        .input-group {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .input-field {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-field:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #666;
        }

        .btn-secondary:hover {
            background: #e0e0e0;
        }

        .answer-card {
            background: #f8f9ff;
            border-left: 4px solid #667eea;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }

        .answer-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .answer-text {
            line-height: 1.8;
            color: #333;
        }

        /* Markdown Ê†∑Âºè */
        .answer-text h1,
        .answer-text h2,
        .answer-text h3,
        .answer-text h4,
        .answer-text h5,
        .answer-text h6 {
            margin-top: 24px;
            margin-bottom: 16px;
            font-weight: 600;
            line-height: 1.25;
        }

        .answer-text h1 {
            font-size: 2em;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 0.3em;
        }

        .answer-text h2 {
            font-size: 1.5em;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 0.3em;
        }

        .answer-text h3 {
            font-size: 1.25em;
        }

        .answer-text p {
            margin-bottom: 16px;
        }

        .answer-text code {
            background-color: rgba(175, 184, 193, 0.2);
            border-radius: 3px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 85%;
            padding: 0.2em 0.4em;
            margin: 0;
        }

        .answer-text pre {
            background-color: #f6f8fa;
            border-radius: 6px;
            padding: 16px;
            overflow: auto;
            margin-bottom: 16px;
        }

        .answer-text pre code {
            background-color: transparent;
            padding: 0;
            font-size: 100%;
            line-height: 1.45;
        }

        .answer-text blockquote {
            border-left: 4px solid #dfe2e5;
            color: #6a737d;
            padding-left: 16px;
            margin: 0 0 16px 0;
        }

        .answer-text ul,
        .answer-text ol {
            margin-bottom: 16px;
            padding-left: 2em;
        }

        .answer-text li {
            margin-bottom: 8px;
        }

        .answer-text table {
            border-collapse: collapse;
            width: 100%;
            margin-bottom: 16px;
        }

        .answer-text table th,
        .answer-text table td {
            border: 1px solid #dfe2e5;
            padding: 8px 12px;
        }

        .answer-text table th {
            background-color: #f6f8fa;
            font-weight: 600;
        }

        .answer-text a {
            color: #667eea;
            text-decoration: none;
        }

        .answer-text a:hover {
            text-decoration: underline;
        }

        .answer-text img {
            max-width: 100%;
            height: auto;
        }

        .answer-text hr {
            border: none;
            border-top: 2px solid #e0e0e0;
            margin: 24px 0;
        }

        .sources {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }

        .sources h4 {
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }

        .source-item {
            background: white;
            padding: 8px 12px;
            border-radius: 4px;
            margin-bottom: 5px;
            font-size: 14px;
            color: #666;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .source-text {
            flex: 1;
            margin-right: 10px;
        }

        .source-actions {
            display: flex;
            gap: 5px;
        }

        .btn-icon {
            padding: 4px 8px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            background: #667eea;
            color: white;
            transition: all 0.2s;
        }

        .btn-icon:hover {
            background: #5568d3;
            transform: translateY(-1px);
        }

        .btn-batch-download {
            margin-top: 10px;
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .btn-batch-download:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
        }

        .search-results {
            display: grid;
            gap: 15px;
        }

        .document-card {
            background: #f8f9fa;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 15px;
            transition: all 0.3s;
        }

        .document-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .document-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
        }

        .document-excerpt {
            color: #666;
            font-size: 14px;
            line-height: 1.6;
        }

        .statistics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 1rem;
            opacity: 0.9;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }

        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .error {
            background: #fff3f3;
            border-left: 4px solid #ff4d4f;
            padding: 15px;
            border-radius: 8px;
            color: #ff4d4f;
            margin-top: 20px;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #999;
        }

        .empty-state-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .response-time {
            font-size: 12px;
            color: #999;
            margin-top: 10px;
        }

        .footer {
            text-align: center;
            color: white;
            padding: 20px;
            opacity: 0.8;
        }

        /* ËØ≠Ë®ÄÂàáÊç¢ÊåâÈíÆ */
        .language-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }

        .language-toggle button {
            background: rgba(255, 255, 255, 0.95);
            border: 2px solid rgba(102, 126, 234, 0.3);
            border-radius: 24px;
            padding: 8px 20px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            color: #667eea;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .language-toggle button:hover {
            background: #667eea;
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(102, 126, 234, 0.4);
        }

        .language-toggle button:active {
            transform: translateY(0);
        }

        /* ÂìçÂ∫îÂºèËÆæËÆ° */
        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }

            .main-content {
                padding: 20px;
            }

            .tabs {
                overflow-x: auto;
            }

            .tab {
                white-space: nowrap;
            }

            .input-group {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, createContext, useContext } = React;

        // ËØ≠Ë®ÄÁøªËØëÂ≠óÂÖ∏
        const translations = {
            zh: {
                // Header
                title: 'ü§ñ Áü•ËØÜÂ∫ìÈóÆÁ≠îÁ≥ªÁªü',
                subtitle: 'Âü∫‰∫é LocalFileRAG ÁöÑÊô∫ËÉΩÈóÆÁ≠îÂπ≥Âè∞',
                statusOnline: '‚úÖ ËøêË°å‰∏≠',
                statusOffline: '‚ùå Á¶ªÁ∫ø',
                status: 'Áä∂ÊÄÅ',

                // Tabs
                tabQA: 'üí¨ Êô∫ËÉΩÈóÆÁ≠î',
                tabSearch: 'üîç ÊñáÊ°£ÊêúÁ¥¢',
                tabDocuments: 'üìÅ ÊñáÊ°£ÁÆ°ÁêÜ',
                tabStats: 'üìä ÁªüËÆ°‰ø°ÊÅØ',

                // QA Tab
                qaPlaceholder: 'ËØ∑ËæìÂÖ•ÊÇ®ÁöÑÈóÆÈ¢ò...',
                qaButton: 'ü§î ÊèêÈóÆ',
                qaThinking: 'ÊÄùËÄÉ‰∏≠...',
                qaAIThinking: 'AI Ê≠£Âú®ÊÄùËÄÉ...',
                qaAnswer: 'üí° ÂõûÁ≠î',
                qaSources: 'üìö ÂèÇËÄÉÊù•Ê∫ê',
                qaDownload: 'üíæ ‰∏ãËΩΩ',
                qaBatchDownload: 'üì¶ ÊâπÈáè‰∏ãËΩΩÂÖ®ÈÉ®',
                qaResponseTime: '‚è±Ô∏è ÂìçÂ∫îÊó∂Èó¥',
                qaEmptyIcon: 'üí≠',
                qaEmptyText: 'Âú®‰∏äÊñπËæìÂÖ•Ê°ÜÊèêÂá∫ÊÇ®ÁöÑÈóÆÈ¢ò',
                qaEmptyExample: 'Á§∫‰æã: "ÊñáÊ°£ÁöÑ‰∏ªË¶ÅÂÜÖÂÆπÊòØ‰ªÄ‰πàÔºü"',
                qaErrorPrefix: '‚ùå',
                qaInputError: 'ËØ∑ËæìÂÖ•ÈóÆÈ¢ò',
                qaDownloadError: '‰∏ãËΩΩÂ§±Ë¥•',
                qaBatchDownloadError: 'ÊâπÈáè‰∏ãËΩΩÂ§±Ë¥•',
                qaRequestError: 'ËØ∑Ê±ÇÂ§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÊúçÂä°ÊòØÂê¶Ê≠£Â∏∏ËøêË°å',

                // Search Tab
                searchPlaceholder: 'ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆËØç',
                searchButton: 'üîç ÊêúÁ¥¢',
                searchSearching: 'ÊêúÁ¥¢‰∏≠...',
                searchResults: 'ÊêúÁ¥¢ÁªìÊûú',
                searchNoResults: 'Êú™ÊâæÂà∞Áõ∏ÂÖ≥ÊñáÊ°£',
                searchEmptyIcon: 'üîç',
                searchEmptyText: 'ËæìÂÖ•ÂÖ≥ÈîÆËØçÊêúÁ¥¢ÊñáÊ°£',
                searchEmptyExample: 'Á§∫‰æã: "ÊäÄÊúØÊñáÊ°£"',
                searchResultsCount: '‰∏™ÁªìÊûú',
                searchScore: 'Áõ∏ÂÖ≥Â∫¶',
                searchResultsLimit: 'ÊúÄÂ§öÊòæÁ§∫',
                searchInputError: 'ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆËØç',
                searchError: 'ÊêúÁ¥¢Â§±Ë¥•',

                // Documents Tab
                docsTitle: 'üìÅ ÊñáÊ°£ÁÆ°ÁêÜ',
                docsUploadArea: 'üì§ ‰∏ä‰º†ÊñáÊ°£',
                docsUploadHint: 'ÁÇπÂáªÊàñÊãñÊãΩÊñá‰ª∂Âà∞Ê≠§Âå∫Âüü‰∏ä‰º†',
                docsUploadSupport: 'ÊîØÊåÅ PDF„ÄÅWord„ÄÅTXT„ÄÅMarkdown„ÄÅExcel„ÄÅPowerPoint„ÄÅÂõæÁâáÁ≠âÊ†ºÂºè',
                docsUploadButton: 'ÈÄâÊã©Êñá‰ª∂',
                docsUploading: '‰∏ä‰º†‰∏≠...',
                docsUploadSuccess: '‚úÖ ‰∏ä‰º†ÊàêÂäü',
                docsUploadError: '‰∏ä‰º†Â§±Ë¥•',
                docsListTitle: 'üìö Â∑≤‰∏ä‰º†ÊñáÊ°£',
                docsListEmpty: 'ÊöÇÊó†ÊñáÊ°£',
                docsListRefresh: 'üîÑ Âà∑Êñ∞ÂàóË°®',
                docsListDelete: 'üóëÔ∏è Âà†Èô§',
                docsListDownload: 'üíæ ‰∏ãËΩΩ',
                docsDeleteConfirm: 'Á°ÆÂÆöË¶ÅÂà†Èô§Ëøô‰∏™Êñá‰ª∂ÂêóÔºü',
                docsDeleteSuccess: 'Âà†Èô§ÊàêÂäü',
                docsDeleteError: 'Âà†Èô§Â§±Ë¥•',
                docsSelectFile: 'ËØ∑ÂÖàÈÄâÊã©Êñá‰ª∂',
                docsFiles: '‰∏™Êñá‰ª∂',

                // Stats Tab
                statsTitle: 'üìä Á≥ªÁªüÁªüËÆ°',
                statsDocCount: 'üìÑ ÊñáÊ°£ÊÄªÊï∞',
                statsIndexedCount: '‚úÖ Â∑≤Á¥¢ÂºïÊñáÊ°£',
                statsCacheHitRate: 'üéØ ÁºìÂ≠òÂëΩ‰∏≠Áéá',
                statsIndexProgress: '‚úÖ Á¥¢ÂºïÂÆåÊàêÂ∫¶',
                statsRefresh: 'üîÑ Âà∑Êñ∞ÁªüËÆ°',
                statsIncrementalIndex: '‚ö° Â¢ûÈáèÁ¥¢Âºï',
                statsRebuildIndex: 'üî® ÈáçÂª∫Á¥¢Âºï',
                statsRebuilding: 'Ê≠£Âú®ÈáçÂª∫Áü•ËØÜÂ∫ìÁ¥¢Âºï...',
                statsIncrementalIndexing: 'Ê≠£Âú®ÊâßË°åÂ¢ûÈáèÁ¥¢Âºï...',
                statsRebuildWait: 'ËøôÂèØËÉΩÈúÄË¶ÅÂá†ÂàÜÈíüÊó∂Èó¥ÔºåËØ∑ËÄêÂøÉÁ≠âÂæÖ',
                statsIncrementalWait: 'Âè™Â§ÑÁêÜÊñ∞Â¢ûÂíå‰øÆÊîπÁöÑÊñáÊ°£ÔºåÈÄüÂ∫¶ËæÉÂø´',
                statsIndexing: '‚è≥ Á¥¢Âºï‰∏≠...',
                statsIndexingProgress: '‚è≥ ÈáçÂª∫‰∏≠...',
                statsSuccess: '‚úÖ Êìç‰ΩúÊàêÂäü',
                statsFailed: '‚ùå Êìç‰ΩúÂ§±Ë¥•',
                statsProcessedFiles: 'üìÑ Â§ÑÁêÜÊñá‰ª∂',
                statsTotalDocs: 'üìö ÊÄªÊñáÊ°£Êï∞',
                statsDuration: '‚è±Ô∏è ËÄóÊó∂',
                statsSuggestion: 'üí°',
                statsIndexGuideTitle: 'üìñ Á¥¢ÂºïËØ¥Êòé',
                statsIncrementalDesc: 'üîÑ Â¢ûÈáèÁ¥¢ÂºïÔºöÂè™Â§ÑÁêÜÊñ∞Â¢ûÂíå‰øÆÊîπÁöÑÊñáÊ°£ÔºåÊÄßËÉΩÊõ¥‰ºòÔºåÊé®ËçêÊó•Â∏∏‰ΩøÁî®',
                statsRebuildDesc: 'üî® ÈáçÂª∫Á¥¢ÂºïÔºöÂÆåÂÖ®ÈáçÂª∫ÊâÄÊúâÊñáÊ°£Á¥¢ÂºïÔºåËÄóÊó∂ËæÉÈïøÔºåÈÄÇÁî®‰∫éÈ¶ñÊ¨°ÊûÑÂª∫ÊàñÂ§ßËßÑÊ®°ÂèòÊõ¥',
                statsSeconds: 'Áßí',
                statsCount: '‰∏™',

                // Footer
                footerText: '¬© 2025 LocalFileRAG Knowledge QA System | Powered by Java & React',

                // Language Toggle
                langToggle: 'üåê English',
            },
            en: {
                // Header
                title: 'ü§ñ Knowledge Base QA System',
                subtitle: 'Intelligent Q&A Platform Based on LocalFileRAG',
                statusOnline: '‚úÖ Online',
                statusOffline: '‚ùå Offline',
                status: 'Status',

                // Tabs
                tabQA: 'üí¨ Q&A',
                tabSearch: 'üîç Search',
                tabDocuments: 'üìÅ Documents',
                tabStats: 'üìä Statistics',

                // QA Tab
                qaPlaceholder: 'Enter your question...',
                qaButton: 'ü§î Ask',
                qaThinking: 'Thinking...',
                qaAIThinking: 'AI is thinking...',
                qaAnswer: 'üí° Answer',
                qaSources: 'üìö References',
                qaDownload: 'üíæ Download',
                qaBatchDownload: 'üì¶ Download All',
                qaResponseTime: '‚è±Ô∏è Response Time',
                qaEmptyIcon: 'üí≠',
                qaEmptyText: 'Enter your question in the input box above',
                qaEmptyExample: 'Example: "What is the main content of the document?"',
                qaErrorPrefix: '‚ùå',
                qaInputError: 'Please enter a question',
                qaDownloadError: 'Download failed',
                qaBatchDownloadError: 'Batch download failed',
                qaRequestError: 'Request failed, please check if the service is running',

                // Search Tab
                searchPlaceholder: 'Enter search keywords',
                searchButton: 'üîç Search',
                searchSearching: 'Searching...',
                searchResults: 'Search Results',
                searchNoResults: 'No documents found',
                searchEmptyIcon: 'üîç',
                searchEmptyText: 'Enter keywords to search documents',
                searchEmptyExample: 'Example: "technical documentation"',
                searchResultsCount: 'results',
                searchScore: 'Score',
                searchResultsLimit: 'Limit',
                searchInputError: 'Please enter search keywords',
                searchError: 'Search failed',

                // Documents Tab
                docsTitle: 'üìÅ Document Management',
                docsUploadArea: 'üì§ Upload Documents',
                docsUploadHint: 'Click or drag files to this area to upload',
                docsUploadSupport: 'Supports PDF, Word, TXT, Markdown, Excel, PowerPoint, Images, etc.',
                docsUploadButton: 'Select File',
                docsUploading: 'Uploading...',
                docsUploadSuccess: '‚úÖ Upload Successful',
                docsUploadError: 'Upload failed',
                docsListTitle: 'üìö Uploaded Documents',
                docsListEmpty: 'No documents',
                docsListRefresh: 'üîÑ Refresh',
                docsListDelete: 'üóëÔ∏è Delete',
                docsListDownload: 'üíæ Download',
                docsDeleteConfirm: 'Are you sure you want to delete this file?',
                docsDeleteSuccess: 'Deleted successfully',
                docsDeleteError: 'Delete failed',
                docsSelectFile: 'Please select a file first',
                docsFiles: 'files',

                // Stats Tab
                statsTitle: 'üìä System Statistics',
                statsDocCount: 'üìÑ Total Documents',
                statsIndexedCount: '‚úÖ Indexed Documents',
                statsCacheHitRate: 'üéØ Cache Hit Rate',
                statsIndexProgress: '‚úÖ Index Progress',
                statsRefresh: 'üîÑ Refresh',
                statsIncrementalIndex: '‚ö° Incremental Index',
                statsRebuildIndex: 'üî® Rebuild Index',
                statsRebuilding: 'Rebuilding knowledge base index...',
                statsIncrementalIndexing: 'Performing incremental indexing...',
                statsRebuildWait: 'This may take a few minutes, please be patient',
                statsIncrementalWait: 'Only processes new and modified documents, faster',
                statsIndexing: '‚è≥ Indexing...',
                statsIndexingProgress: '‚è≥ Rebuilding...',
                statsSuccess: '‚úÖ Operation Successful',
                statsFailed: '‚ùå Operation Failed',
                statsProcessedFiles: 'üìÑ Processed Files',
                statsTotalDocs: 'üìö Total Documents',
                statsDuration: '‚è±Ô∏è Duration',
                statsSuggestion: 'üí°',
                statsIndexGuideTitle: 'üìñ Index Guide',
                statsIncrementalDesc: 'üîÑ Incremental Index: Only processes new and modified documents, better performance, recommended for daily use',
                statsRebuildDesc: 'üî® Rebuild Index: Completely rebuilds all document indexes, takes longer, suitable for initial setup or major changes',
                statsSeconds: 's',
                statsCount: '',

                // Footer
                footerText: '¬© 2025 LocalFileRAG Knowledge QA System | Powered by Java & React',

                // Language Toggle
                langToggle: 'üåê ‰∏≠Êñá',
            }
        };

        // ÂàõÂª∫ËØ≠Ë®Ä‰∏ä‰∏ãÊñá
        const LanguageContext = createContext();

        // ËØ≠Ë®ÄÊèê‰æõËÄÖÁªÑ‰ª∂
        function LanguageProvider({ children }) {
            const [language, setLanguage] = useState(() => {
                return localStorage.getItem('language') || 'zh';
            });

            const toggleLanguage = () => {
                const newLang = language === 'zh' ? 'en' : 'zh';
                setLanguage(newLang);
                localStorage.setItem('language', newLang);
                document.getElementById('html-root').setAttribute('lang', newLang === 'zh' ? 'zh-CN' : 'en');
            };

            const t = (key) => {
                return translations[language][key] || key;
            };

            return (
                <LanguageContext.Provider value={{ language, toggleLanguage, t }}>
                    {children}
                </LanguageContext.Provider>
            );
        }

        // Ëá™ÂÆö‰πâ Hook ‰ΩøÁî®ËØ≠Ë®Ä
        function useTranslation() {
            return useContext(LanguageContext);
        }

        // API ÈÖçÁΩÆ
        const API_BASE_URL = 'http://localhost:8080/api/qa';

        // API Ë∞ÉÁî®ÂáΩÊï∞
        const API_DOCS_URL = 'http://localhost:8080/api/documents';

        const api = {
            ask: async (question) => {
                const response = await axios.post(`${API_BASE_URL}/ask`, { question });
                return response.data;
            },
            search: async (query, limit = 10) => {
                const response = await axios.get(`${API_BASE_URL}/search`, {
                    params: { query, limit }
                });
                return response.data;
            },
            getStatistics: async () => {
                const response = await axios.get(`${API_BASE_URL}/statistics`);
                return response.data;
            },
            health: async () => {
                const response = await axios.get(`${API_BASE_URL}/health`);
                return response.data;
            },
            rebuild: async () => {
                const response = await axios.post(`${API_BASE_URL}/rebuild`);
                return response.data;
            },
            incrementalIndex: async () => {
                const response = await axios.post(`${API_BASE_URL}/incremental-index`);
                return response.data;
            },
            // ÊñáÊ°£ÁÆ°ÁêÜ API
            uploadDocument: async (file) => {
                const formData = new FormData();
                formData.append('file', file);
                const response = await axios.post(`${API_DOCS_URL}/upload`, formData, {
                    headers: { 'Content-Type': 'multipart/form-data' }
                });
                return response.data;
            },
            listDocuments: async () => {
                const response = await axios.get(`${API_DOCS_URL}/list`);
                return response.data;
            },
            deleteDocument: async (fileName) => {
                const response = await axios.delete(`${API_DOCS_URL}/${encodeURIComponent(fileName)}`);
                return response.data;
            },
            downloadDocument: async (fileName) => {
                const response = await axios.get(`${API_DOCS_URL}/download/${encodeURIComponent(fileName)}`, {
                    responseType: 'blob'
                });
                return response.data;
            },
            downloadBatch: async (fileNames) => {
                const response = await axios.post(`${API_DOCS_URL}/download-batch`, fileNames, {
                    responseType: 'blob'
                });
                return response.data;
            }
        };

        // ÈóÆÁ≠îÁªÑ‰ª∂
        function QATab() {
            const { t } = useTranslation();
            const [question, setQuestion] = useState('');
            const [answer, setAnswer] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);

            // ÈÖçÁΩÆ marked
            useEffect(() => {
                if (typeof marked !== 'undefined') {
                    marked.setOptions({
                        breaks: true,
                        gfm: true,
                        headerIds: true,
                        mangle: false
                    });
                }
            }, []);

            // ÂΩìÁ≠îÊ°àÊõ¥Êñ∞Êó∂ÔºåÈ´ò‰∫Æ‰ª£Á†ÅÂùó
            useEffect(() => {
                if (answer && typeof hljs !== 'undefined') {
                    document.querySelectorAll('.answer-text pre code').forEach((block) => {
                        hljs.highlightElement(block);
                    });
                }
            }, [answer]);

            const handleAsk = async () => {
                if (!question.trim()) {
                    alert(t('qaInputError'));
                    return;
                }

                setLoading(true);
                setError(null);
                setAnswer(null);

                try {
                    const result = await api.ask(question);
                    setAnswer(result);
                } catch (err) {
                    setError(err.message || t('qaRequestError'));
                } finally {
                    setLoading(false);
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleAsk();
                }
            };

            // ‰∏ãËΩΩÂçï‰∏™Êñá‰ª∂
            const handleDownload = async (fileName) => {
                try {
                    const blob = await api.downloadDocument(fileName);
                    const url = window.URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = fileName;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    window.URL.revokeObjectURL(url);
                } catch (err) {
                    alert(t('qaDownloadError') + ': ' + err.message);
                }
            };

            // ÊâπÈáè‰∏ãËΩΩÊâÄÊúâÂèÇËÄÉÊñá‰ª∂
            const handleBatchDownload = async () => {
                if (!answer || !answer.sources || answer.sources.length === 0) {
                    return;
                }

                try {
                    const blob = await api.downloadBatch(answer.sources);
                    const url = window.URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `references_${new Date().getTime()}.zip`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    window.URL.revokeObjectURL(url);
                } catch (err) {
                    alert(t('qaBatchDownloadError') + ': ' + err.message);
                }
            };

            return (
                <div className="qa-section">
                    <div className="input-group">
                        <input
                            type="text"
                            className="input-field"
                            placeholder={t('qaPlaceholder')}
                            value={question}
                            onChange={(e) => setQuestion(e.target.value)}
                            onKeyPress={handleKeyPress}
                            disabled={loading}
                        />
                        <button
                            className="btn btn-primary"
                            onClick={handleAsk}
                            disabled={loading}
                        >
                            {loading ? t('qaThinking') : t('qaButton')}
                        </button>
                    </div>

                    {loading && (
                        <div className="loading">
                            <div className="spinner"></div>
                            <p>{t('qaAIThinking')}</p>
                        </div>
                    )}

                    {error && (
                        <div className="error">
                            {t('qaErrorPrefix')} {error}
                        </div>
                    )}

                    {answer && !loading && (
                        <div className="answer-card">
                            <h3>{t('qaAnswer')}</h3>
                            <div
                                className="answer-text"
                                dangerouslySetInnerHTML={{
                                    __html: typeof marked !== 'undefined'
                                        ? marked.parse(answer.answer)
                                        : answer.answer
                                }}
                            ></div>

                            {answer.sources && answer.sources.length > 0 && (
                                <div className="sources">
                                    <h4>{t('qaSources')}</h4>
                                    {answer.sources.map((source, index) => (
                                        <div key={index} className="source-item">
                                            <span className="source-text">
                                                {index + 1}. {source}
                                            </span>
                            <div className="source-actions">
                                                <button
                                                    className="btn-icon"
                                                    onClick={() => handleDownload(source)}
                                                    title={t('qaDownload')}
                                                >
                                                    {t('qaDownload')}
                                                </button>
                                            </div>
                                        </div>
                                    ))}
                                    {answer.sources.length > 1 && (
                                        <button
                                            className="btn-batch-download"
                                            onClick={handleBatchDownload}
                                        >
                                            {t('qaBatchDownload')} ({answer.sources.length} {t('docsFiles')})
                                        </button>
                                    )}
                                </div>
                            )}

                            <div className="response-time">
                                {t('qaResponseTime')}: {answer.responseTimeMs}ms
                            </div>
                        </div>
                    )}

                    {!answer && !loading && !error && (
                        <div className="empty-state">
                            <div className="empty-state-icon">{t('qaEmptyIcon')}</div>
                            <p>{t('qaEmptyText')}</p>
                            <p style={{fontSize: '14px', marginTop: '10px', color: '#ccc'}}>
                                {t('qaEmptyExample')}
                            </p>
                        </div>
                    )}
                </div>
            );
        }

        // ÊêúÁ¥¢ÁªÑ‰ª∂
        function SearchTab() {
            const { t } = useTranslation();
            const [query, setQuery] = useState('');
            const [results, setResults] = useState(null);
            const [loading, setLoading] = useState(false);
            const [error, setError] = useState(null);
            const [limit, setLimit] = useState(10);

            const handleSearch = async () => {
                if (!query.trim()) {
                    alert(t('searchInputError'));
                    return;
                }

                setLoading(true);
                setError(null);
                setResults(null);

                try {
                    const result = await api.search(query, limit);
                    setResults(result);
                } catch (err) {
                    setError(err.message || t('searchError'));
                } finally {
                    setLoading(false);
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter') {
                    e.preventDefault();
                    handleSearch();
                }
            };

            return (
                <div className="search-section">
                    <div className="input-group">
                        <input
                            type="text"
                            className="input-field"
                            placeholder={t('searchPlaceholder')}
                            value={query}
                            onChange={(e) => setQuery(e.target.value)}
                            onKeyPress={handleKeyPress}
                            disabled={loading}
                        />
                        <select
                            className="input-field"
                            style={{flex: '0 0 120px'}}
                            value={limit}
                            onChange={(e) => setLimit(Number(e.target.value))}
                        >
                            <option value={5}>5</option>
                            <option value={10}>10</option>
                            <option value={20}>20</option>
                            <option value={50}>50</option>
                        </select>
                        <button
                            className="btn btn-primary"
                            onClick={handleSearch}
                            disabled={loading}
                        >
                            {loading ? t('searchSearching') : t('searchButton')}
                        </button>
                    </div>

                    {loading && (
                        <div className="loading">
                            <div className="spinner"></div>
                            <p>{t('searchSearching')}</p>
                        </div>
                    )}

                    {error && (
                        <div className="error">
                            {t('qaErrorPrefix')} {error}
                        </div>
                    )}

                    {results && !loading && (
                        <div>
                            <div style={{marginBottom: '15px', color: '#666'}}>
                                <strong>{results.total}</strong> {t('searchResultsCount')}
                            </div>

                            <div className="search-results">
                                {results.documents.map((doc, index) => (
                                    <div key={doc.id} className="document-card">
                                        <div className="document-title">
                                            üìÑ {doc.title || `Document ${index + 1}`}
                                        </div>
                                        <div className="document-excerpt">
                                            {doc.excerpt}
                                        </div>
                                    </div>
                                ))}
                            </div>
                        </div>
                    )}

                    {!results && !loading && !error && (
                        <div className="empty-state">
                            <div className="empty-state-icon">{t('searchEmptyIcon')}</div>
                            <p>{t('searchEmptyText')}</p>
                        </div>
                    )}
                </div>
            );
        }

        // ÊñáÊ°£ÁÆ°ÁêÜÁªÑ‰ª∂
        function DocumentsTab() {
            const { t } = useTranslation();
            const [documents, setDocuments] = useState([]);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [uploading, setUploading] = useState(false);
            const [uploadProgress, setUploadProgress] = useState(null);
            const [filterText, setFilterText] = useState('');

            useEffect(() => {
                loadDocuments();
            }, []);

            const loadDocuments = async () => {
                setLoading(true);
                setError(null);

                try {
                    console.log('ÂºÄÂßãÂä†ËΩΩÊñáÊ°£ÂàóË°®...');
                    const result = await api.listDocuments();
                    console.log('ÊñáÊ°£ÂàóË°®ÂìçÂ∫î:', result);

                    if (result.success) {
                        setDocuments(result.documents || []);
                        console.log('Âä†ËΩΩÂà∞', result.documents?.length || 0, '‰∏™ÊñáÊ°£');
                    } else {
                        const errorMsg = result.message || 'Ëé∑ÂèñÊñáÊ°£ÂàóË°®Â§±Ë¥•';
                        console.error('Âä†ËΩΩÂ§±Ë¥•:', errorMsg);
                        setError(errorMsg);
                    }
                } catch (err) {
                    console.error('Âä†ËΩΩÊñáÊ°£ÂàóË°®ÂºÇÂ∏∏:', err);
                    const errorMsg = err.response?.data?.message || err.message || 'Âä†ËΩΩÊñáÊ°£ÂàóË°®Â§±Ë¥•ÔºåËØ∑Ê£ÄÊü•ÊúçÂä°ÊòØÂê¶Ê≠£Â∏∏ËøêË°å';
                    setError(errorMsg);
                } finally {
                    setLoading(false);
                }
            };

            const handleFileSelect = async (event) => {
                const files = event.target.files;
                if (!files || files.length === 0) return;

                setUploading(true);
                setUploadProgress({ total: files.length, current: 0, success: 0, failed: 0 });

                for (let i = 0; i < files.length; i++) {
                    const file = files[i];
                    try {
                        await api.uploadDocument(file);
                        setUploadProgress(prev => ({ ...prev, current: i + 1, success: prev.success + 1 }));
                    } catch (err) {
                        setUploadProgress(prev => ({ ...prev, current: i + 1, failed: prev.failed + 1 }));
                    }
                }

                setUploading(false);
                setTimeout(() => setUploadProgress(null), 3000);
                loadDocuments();

                // Ê∏ÖÁ©∫Êñá‰ª∂ËæìÂÖ•
                event.target.value = '';
            };

            const handleDelete = async (fileName) => {
                if (!confirm(t('docsDeleteConfirm'))) {
                    return;
                }

                try {
                    const result = await api.deleteDocument(fileName);
                    if (result.success) {
                        alert(t('docsDeleteSuccess'));
                        loadDocuments();
                    } else {
                        alert(t('docsDeleteError') + ': ' + result.message);
                    }
                } catch (err) {
                    alert(t('docsDeleteError') + ': ' + err.message);
                }
            };

            const formatFileSize = (bytes) => {
                if (bytes < 1024) return bytes + ' B';
                if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(2) + ' KB';
                return (bytes / 1024 / 1024).toFixed(2) + ' MB';
            };

            // ËøáÊª§ÊñáÊ°£ÂàóË°®
            const filteredDocuments = documents.filter(doc =>
                doc.fileName.toLowerCase().includes(filterText.toLowerCase())
            );

            return (
                <div>
                    {/* ‰∏ä‰º†Âå∫Âüü */}
                    <div style={{marginBottom: '30px', padding: '20px', background: '#f8f9ff', borderRadius: '8px'}}>
                        <h3 style={{marginBottom: '15px'}}>üì§ ‰∏ä‰º†ÊñáÊ°£</h3>
                        <input
                            type="file"
                            id="fileInput"
                            multiple
                            accept=".xlsx,.xls,.docx,.doc,.pptx,.ppt,.pdf,.txt,.md,.html,.xml"
                            onChange={handleFileSelect}
                            disabled={uploading}
                            style={{display: 'none'}}
                        />
                        <label htmlFor="fileInput" className="btn btn-primary" style={{display: 'inline-block', cursor: uploading ? 'not-allowed' : 'pointer', opacity: uploading ? 0.5 : 1}}>
                            {uploading ? '‚è≥ ‰∏ä‰º†‰∏≠...' : 'üìÅ ÈÄâÊã©Êñá‰ª∂'}
                        </label>
                        <p style={{marginTop: '10px', fontSize: '14px', color: '#666'}}>
                            ÊîØÊåÅÊ†ºÂºè: Excel, Word, PowerPoint, PDF, TXT, MD, HTML, XML
                        </p>

                        {uploadProgress && (
                            <div style={{marginTop: '15px', padding: '10px', background: 'white', borderRadius: '4px'}}>
                                <div>üìä ‰∏ä‰º†ËøõÂ∫¶: {uploadProgress.current}/{uploadProgress.total}</div>
                                <div style={{fontSize: '14px', color: '#666', marginTop: '5px'}}>
                                    ‚úÖ ÊàêÂäü: {uploadProgress.success} | ‚ùå Â§±Ë¥•: {uploadProgress.failed}
                                </div>
                            </div>
                        )}
                    </div>

                    {/* ÊñáÊ°£ÂàóË°®Âå∫Âüü */}
                    <div>
                        <div style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center', marginBottom: '15px'}}>
                            <h3>üìö ÊñáÊ°£ÂàóË°® {!loading && `(${filteredDocuments.length}/${documents.length})`}</h3>
                            <button
                                className="btn btn-secondary"
                                onClick={loadDocuments}
                                disabled={loading}
                            >
                                {loading ? '‚è≥ Âä†ËΩΩ‰∏≠...' : 'üîÑ Âà∑Êñ∞'}
                            </button>
                        </div>

                        {/* Êñá‰ª∂ÂêçËøáÊª§ËæìÂÖ•Ê°Ü */}
                        {!loading && documents.length > 0 && (
                            <div style={{marginBottom: '15px'}}>
                                <input
                                    type="text"
                                    className="input-field"
                                    placeholder="üîç ËæìÂÖ•Êñá‰ª∂ÂêçËøõË°åËøáÊª§..."
                                    value={filterText}
                                    onChange={(e) => setFilterText(e.target.value)}
                                    style={{width: '100%'}}
                                />
                                {filterText && (
                                    <div style={{fontSize: '13px', color: '#666', marginTop: '5px'}}>
                                        ËøáÊª§ÁªìÊûú: {filteredDocuments.length} / {documents.length} ‰∏™ÊñáÊ°£
                                        <button
                                            onClick={() => setFilterText('')}
                                            style={{
                                                marginLeft: '10px',
                                                background: 'none',
                                                border: 'none',
                                                color: '#667eea',
                                                cursor: 'pointer',
                                                textDecoration: 'underline',
                                                fontSize: '13px'
                                            }}
                                        >
                                            Ê∏ÖÈô§ËøáÊª§
                                        </button>
                                    </div>
                                )}
                            </div>
                        )}

                        {/* Âä†ËΩΩÁä∂ÊÄÅ */}
                        {loading && (
                            <div className="loading">
                                <div className="spinner"></div>
                                <p>Âä†ËΩΩÊñáÊ°£ÂàóË°®...</p>
                            </div>
                        )}

                        {/* ÈîôËØØÁä∂ÊÄÅ */}
                        {error && !loading && (
                            <div className="error">
                                ‚ùå {error}
                                <button
                                    className="btn btn-secondary"
                                    onClick={loadDocuments}
                                    style={{marginTop: '10px', display: 'block'}}
                                >
                                    ÈáçËØï
                                </button>
                            </div>
                        )}

                        {/* Á©∫Áä∂ÊÄÅ */}
                        {!error && !loading && documents.length === 0 && (
                            <div className="empty-state">
                                <div className="empty-state-icon">üìÅ</div>
                                <p>ÊöÇÊó†ÊñáÊ°£</p>
                                <p style={{fontSize: '14px', marginTop: '10px', color: '#ccc'}}>
                                    ÁÇπÂáª‰∏äÊñπÊåâÈíÆ‰∏ä‰º†ÊñáÊ°£
                                </p>
                            </div>
                        )}

                        {/* ÊñáÊ°£ÂàóË°® */}
                        {!error && !loading && documents.length > 0 && (
                            <>
                            {filteredDocuments.length > 0 ? (
                            <div style={{display: 'grid', gap: '10px'}}>
                                {filteredDocuments.map((doc, index) => (
                                    <div key={index} className="document-card" style={{display: 'flex', justifyContent: 'space-between', alignItems: 'center'}}>
                                        <div style={{flex: 1}}>
                                            <div className="document-title">
                                                üìÑ {doc.fileName}
                                            </div>
                                            <div style={{fontSize: '13px', color: '#999', marginTop: '5px'}}>
                                                üì¶ {formatFileSize(doc.fileSize)} |
                                                üìÖ {doc.uploadTime} |
                                                üè∑Ô∏è {doc.fileType.toUpperCase()}
                                                {doc.indexed && <span style={{marginLeft: '5px'}}>| ‚úÖ Â∑≤Á¥¢Âºï</span>}
                                            </div>
                                        </div>
                                        <button
                                            className="btn btn-secondary"
                                            onClick={() => handleDelete(doc.fileName)}
                                            style={{
                                                padding: '8px 16px',
                                                background: '#ff4d4f',
                                                color: 'white',
                                                marginLeft: '10px'
                                            }}
                                        >
                                            üóëÔ∏è Âà†Èô§
                                        </button>
                                    </div>
                                ))}
                            </div>
                            ) : (
                                <div className="empty-state">
                                    <div className="empty-state-icon">üîç</div>
                                    <p>Ê≤°ÊúâÊâæÂà∞ÂåπÈÖç "{filterText}" ÁöÑÊñáÊ°£</p>
                                    <button
                                        className="btn btn-secondary"
                                        onClick={() => setFilterText('')}
                                        style={{marginTop: '15px'}}
                                    >
                                        Ê∏ÖÈô§ËøáÊª§
                                    </button>
                                </div>
                            )}
                            </>
                        )}

                        {/* ÊèêÁ§∫‰ø°ÊÅØ */}
                        {!error && !loading && documents.length > 0 && (
                            <div style={{marginTop: '20px', padding: '15px', background: '#fff3cd', borderRadius: '8px', fontSize: '14px'}}>
                                üí° <strong>ÊèêÁ§∫Ôºö</strong>‰∏ä‰º†ÊàñÂà†Èô§ÊñáÊ°£ÂêéÔºåÂª∫ËÆÆÂâçÂæÄ"ÁªüËÆ°‰ø°ÊÅØ"È°µÈù¢<strong>ÈáçÂª∫Á¥¢Âºï</strong>Ôºå‰ª•‰æøÊêúÁ¥¢Âà∞ÊúÄÊñ∞ÂÜÖÂÆπ„ÄÇ
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // ÁªüËÆ°‰ø°ÊÅØÁªÑ‰ª∂
        function StatisticsTab() {
            const { t } = useTranslation();
            const [stats, setStats] = useState(null);
            const [loading, setLoading] = useState(true);
            const [error, setError] = useState(null);
            const [rebuilding, setRebuilding] = useState(false);
            const [incrementalIndexing, setIncrementalIndexing] = useState(false);
            const [rebuildResult, setRebuildResult] = useState(null);

            useEffect(() => {
                loadStatistics();
            }, []);

            const loadStatistics = async () => {
                setLoading(true);
                setError(null);

                try {
                    const result = await api.getStatistics();
                    setStats(result);
                } catch (err) {
                    setError(err.message || 'Âä†ËΩΩÁªüËÆ°‰ø°ÊÅØÂ§±Ë¥•');
                } finally {
                    setLoading(false);
                }
            };

            const handleRebuild = async () => {
                if (!confirm('Á°ÆÂÆöË¶ÅÈáçÂª∫Áü•ËØÜÂ∫ìÁ¥¢ÂºïÂêóÔºü\n\nËøôÂ∞ÜÈáçÊñ∞Â§ÑÁêÜÊâÄÊúâÊñáÊ°£ÔºåÂèØËÉΩÈúÄË¶ÅËæÉÈïøÊó∂Èó¥„ÄÇ')) {
                    return;
                }

                setRebuilding(true);
                setError(null);
                setRebuildResult(null);

                try {
                    const result = await api.rebuild();
                    setRebuildResult(result);

                    if (result.success) {
                        // ÈáçÂª∫ÊàêÂäüÂêéÂà∑Êñ∞ÁªüËÆ°‰ø°ÊÅØ
                        setTimeout(() => {
                            loadStatistics();
                        }, 1000);
                    }
                } catch (err) {
                    setError(err.message || 'ÈáçÂª∫Â§±Ë¥•');
                } finally {
                    setRebuilding(false);
                }
            };

            const handleIncrementalIndex = async () => {
                if (!confirm('Á°ÆÂÆöË¶ÅÊâßË°åÂ¢ûÈáèÁ¥¢ÂºïÂêóÔºü\n\nÂè™‰ºöÂ§ÑÁêÜÊñ∞Â¢ûÂíå‰øÆÊîπÁöÑÊñáÊ°£ÔºåÈÄüÂ∫¶Êõ¥Âø´„ÄÇ')) {
                    return;
                }

                setIncrementalIndexing(true);
                setError(null);
                setRebuildResult(null);

                try {
                    const result = await api.incrementalIndex();
                    setRebuildResult(result);

                    if (result.success) {
                        // Â¢ûÈáèÁ¥¢ÂºïÊàêÂäüÂêéÂà∑Êñ∞ÁªüËÆ°‰ø°ÊÅØ
                        setTimeout(() => {
                            loadStatistics();
                        }, 1000);
                    }
                } catch (err) {
                    setError(err.message || 'Â¢ûÈáèÁ¥¢ÂºïÂ§±Ë¥•');
                } finally {
                    setIncrementalIndexing(false);
                }
            };

            if (loading) {
                return (
                    <div className="loading">
                        <div className="spinner"></div>
                        <p>Âä†ËΩΩÁªüËÆ°‰ø°ÊÅØ...</p>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="error">
                        ‚ùå {error}
                        <button
                            className="btn btn-secondary"
                            onClick={loadStatistics}
                            style={{marginTop: '10px'}}
                        >
                            ÈáçËØï
                        </button>
                    </div>
                );
            }

            return (
                <div>
                    <div className="statistics-grid">
                        <div className="stat-card">
                            <div className="stat-value">{stats.documentCount}</div>
                            <div className="stat-label">{t('statsDocCount')}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-value">{stats.indexedDocumentCount}</div>
                            <div className="stat-label">{t('statsIndexedCount')}</div>
                        </div>
                        <div className="stat-card">
                            <div className="stat-value">
                                {stats.documentCount > 0
                                    ? Math.round((stats.indexedDocumentCount / stats.documentCount) * 100)
                                    : 0}%
                            </div>
                            <div className="stat-label">{t('statsIndexProgress')}</div>
                        </div>
                    </div>

                    {(rebuilding || incrementalIndexing) && (
                        <div className="loading" style={{marginTop: '30px'}}>
                            <div className="spinner"></div>
                            <p>{rebuilding ? t('statsRebuilding') : t('statsIncrementalIndexing')}</p>
                            <p style={{fontSize: '14px', color: '#999', marginTop: '10px'}}>
                                {rebuilding ? t('statsRebuildWait') : t('statsIncrementalWait')}
                            </p>
                        </div>
                    )}

                    {rebuildResult && !rebuilding && !incrementalIndexing && (
                        <div className={rebuildResult.success ? 'answer-card' : 'error'} style={{marginTop: '30px'}}>
                            <h3>{rebuildResult.success ? t('statsSuccess') : t('statsFailed')}</h3>
                            <div style={{marginTop: '10px'}}>
                                <p>{rebuildResult.message}</p>
                                {rebuildResult.success && rebuildResult.processedFiles > 0 && (
                                    <div style={{marginTop: '15px', fontSize: '14px'}}>
                                        <p>{t('statsProcessedFiles')}: {rebuildResult.processedFiles} {t('statsCount')}</p>
                                        <p>{t('statsTotalDocs')}: {rebuildResult.totalDocuments} {t('statsCount')}</p>
                                        <p>{t('statsDuration')}: {(rebuildResult.durationMs / 1000).toFixed(2)} {t('statsSeconds')}</p>
                                    </div>
                                )}
                                {rebuildResult.suggestion && (
                                    <p style={{marginTop: '10px', fontSize: '14px', color: '#666'}}>
                                        {t('statsSuggestion')} {rebuildResult.suggestion}
                                    </p>
                                )}
                            </div>
                        </div>
                    )}

                    <div style={{marginTop: '30px'}}>
                        <div style={{padding: '20px', background: '#f8f9ff', borderRadius: '8px', marginBottom: '20px'}}>
                            <h4 style={{marginBottom: '10px', color: '#667eea'}}>{t('statsIndexGuideTitle')}</h4>
                            <div style={{fontSize: '14px', lineHeight: '1.8', color: '#666'}}>
                                <p style={{marginBottom: '8px'}}>
                                    {t('statsIncrementalDesc')}
                                </p>
                                <p>
                                    {t('statsRebuildDesc')}
                                </p>
                            </div>
                        </div>

                        <div style={{textAlign: 'center', display: 'flex', gap: '10px', justifyContent: 'center', flexWrap: 'wrap'}}>
                            <button
                                className="btn btn-secondary"
                                onClick={loadStatistics}
                                disabled={rebuilding || incrementalIndexing}
                            >
                                {t('statsRefresh')}
                            </button>
                            <button
                                className="btn btn-primary"
                                onClick={handleIncrementalIndex}
                                disabled={rebuilding || incrementalIndexing}
                                style={{
                                    background: incrementalIndexing ? '#ccc' : 'linear-gradient(135deg, #52c41a 0%, #73d13d 100%)'
                                }}
                            >
                                {incrementalIndexing ? t('statsIndexing') : t('statsIncrementalIndex')}
                            </button>
                            <button
                                className="btn btn-primary"
                                onClick={handleRebuild}
                                disabled={rebuilding || incrementalIndexing}
                            >
                                {rebuilding ? t('statsIndexingProgress') : t('statsRebuildIndex')}
                            </button>
                        </div>
                    </div>
                </div>
            );
        }

        // ‰∏ªÂ∫îÁî®ÁªÑ‰ª∂
        function App() {
            const { t, toggleLanguage, language } = useTranslation();
            const [activeTab, setActiveTab] = useState('qa');
            const [health, setHealth] = useState(null);

            useEffect(() => {
                checkHealth();
            }, []);

            const checkHealth = async () => {
                try {
                    const result = await api.health();
                    setHealth(result);
                } catch (err) {
                    setHealth({ status: 'DOWN', message: 'Service connection failed' });
                }
            };

            return (
                <div className="app-container">
                    {/* ËØ≠Ë®ÄÂàáÊç¢ÊåâÈíÆ */}
                    <div className="language-toggle">
                        <button onClick={toggleLanguage}>
                            {t('langToggle')}
                        </button>
                    </div>

                    <header className="header">
                        <h1>{t('title')}</h1>
                        <p>{t('subtitle')}</p>
                        {health && (
                            <div style={{marginTop: '10px', fontSize: '14px'}}>
                                {t('status')}: {health.status === 'UP' ? t('statusOnline') : t('statusOffline')}
                            </div>
                        )}
                    </header>

                    <main className="main-content">
                        <div className="tabs">
                            <button
                                className={`tab ${activeTab === 'qa' ? 'active' : ''}`}
                                onClick={() => setActiveTab('qa')}
                            >
                                {t('tabQA')}
                            </button>
                            <button
                                className={`tab ${activeTab === 'search' ? 'active' : ''}`}
                                onClick={() => setActiveTab('search')}
                            >
                                {t('tabSearch')}
                            </button>
                            <button
                                className={`tab ${activeTab === 'documents' ? 'active' : ''}`}
                                onClick={() => setActiveTab('documents')}
                            >
                                {t('tabDocuments')}
                            </button>
                            <button
                                className={`tab ${activeTab === 'stats' ? 'active' : ''}`}
                                onClick={() => setActiveTab('stats')}
                            >
                                {t('tabStats')}
                            </button>
                        </div>

                        <div className="tab-content">
                            {activeTab === 'qa' && <QATab />}
                            {activeTab === 'search' && <SearchTab />}
                            {activeTab === 'documents' && <DocumentsTab />}
                            {activeTab === 'stats' && <StatisticsTab />}
                        </div>
                    </main>

                    <footer className="footer">
                        <p>{t('footerText')}</p>
                    </footer>
                </div>
            );
        }

        // Ê∏≤ÊüìÂ∫îÁî®
        ReactDOM.render(
            <LanguageProvider>
                <App />
            </LanguageProvider>,
            document.getElementById('root')
        );
    </script>
</body>
</html>

