# ğŸ“š Chunking é…ç½®ä½¿ç”¨æ—¶æœºåˆ†æ

**æ–‡æ¡£åˆ›å»ºæ—¶é—´ï¼š** 2025-12-07  
**ç‰ˆæœ¬ï¼š** v1.0

---

## ğŸ¯ æ ¸å¿ƒé—®é¢˜

åœ¨é…ç½®æ–‡ä»¶ä¸­æœ‰ä¸¤ä¸ªçœ‹èµ·æ¥ç›¸ä¼¼çš„é…ç½®é¡¹ï¼š

1. **`knowledge.qa.llm.chunking.ai-chunking`** - é—®ç­”æ—¶çš„ AI è¯­ä¹‰åˆ‡åˆ†
2. **`knowledge.qa.ppl.chunking.llm-chunking`** - ç´¢å¼•æ—¶çš„ LLM æ™ºèƒ½åˆ†å—

è¿™ä¸¤ä¸ªé…ç½®çš„ä½¿ç”¨æ—¶æœºå’Œç›®çš„**å®Œå…¨ä¸åŒ**ï¼

---

## ğŸ“Š å¿«é€Ÿå¯¹æ¯”è¡¨

| ç‰¹æ€§ | llm.chunking.ai-chunking | ppl.chunking.llm-chunking |
|------|-------------------------|--------------------------|
| **ä½¿ç”¨é˜¶æ®µ** | âœ… é—®ç­”æ—¶ï¼ˆQuery Timeï¼‰ | âœ… ç´¢å¼•æ—¶ï¼ˆIndex Timeï¼‰ |
| **è§¦å‘åœºæ™¯** | ç”¨æˆ·æé—®ï¼Œæ£€ç´¢æ–‡æ¡£å | ä¸Šä¼ æ–‡æ¡£ï¼Œå»ºç«‹ç´¢å¼•æ—¶ |
| **ä½œç”¨å¯¹è±¡** | æ£€ç´¢åˆ°çš„æ–‡æ¡£ç‰‡æ®µ | åŸå§‹å®Œæ•´æ–‡æ¡£ |
| **æ‰§è¡Œä½ç½®** | `SmartContextBuilder` | `DocumentPreprocessingService` |
| **ç›®çš„** | é€‚é… LLM ä¸Šä¸‹æ–‡çª—å£ | æé«˜æ£€ç´¢ç²¾åº¦ |
| **è°ƒç”¨é¢‘ç‡** | æ¯æ¬¡é—®ç­”éƒ½ä¼šè°ƒç”¨ | æ¯ä¸ªæ–‡æ¡£ä»…ç´¢å¼•ä¸€æ¬¡ |
| **æ€§èƒ½å½±å“** | å½±å“é—®ç­”å»¶è¿Ÿ | å½±å“ç´¢å¼•é€Ÿåº¦ |
| **è´¹ç”¨å½±å“** | æ¯æ¬¡é—®ç­”éƒ½äº§ç”Ÿè´¹ç”¨ | ä»…ç´¢å¼•æ—¶äº§ç”Ÿè´¹ç”¨ |

---

## 1ï¸âƒ£ `knowledge.qa.llm.chunking.ai-chunking`

### ğŸ“ é…ç½®ä½ç½®

```yaml
knowledge:
  qa:
    llm:
      # æ–‡æ¡£åˆ‡åˆ†ç­–ç•¥: SIMPLE, SMART_KEYWORD, AI_SEMANTIC, NONE
      chunking-strategy: SMART_KEYWORD
      
      chunking:
        chunk-size: 4000
        chunk-overlap: 400
        split-on-sentence: true
        
        # AI è¯­ä¹‰åˆ‡åˆ†é…ç½®
        ai-chunking:
          enabled: false                    # âš ï¸ æˆæœ¬è¾ƒé«˜ï¼Œå»ºè®®å…³é—­
          model: deepseek-chat
          prompt: |
            è¯·å°†ä»¥ä¸‹æ–‡æ¡£æ™ºèƒ½åˆ‡åˆ†æˆå¤šä¸ªè¯­ä¹‰å®Œæ•´çš„æ®µè½...
```

### â° ä½¿ç”¨æ—¶æœº

**é˜¶æ®µï¼šé—®ç­”æ—¶ï¼ˆQuery Timeï¼‰**

```
ç”¨æˆ·æé—® "è¿™ä¸ªäº§å“çš„ä»·æ ¼æ˜¯å¤šå°‘ï¼Ÿ"
    â†“
1. æ£€ç´¢ç›¸å…³æ–‡æ¡£ï¼ˆLucene + å‘é‡æ£€ç´¢ï¼‰
    â†“
2. è·å¾—æ–‡æ¡£åˆ—è¡¨ï¼ˆå¯èƒ½å¾ˆé•¿ï¼Œè¶…è¿‡ LLM ä¸Šä¸‹æ–‡çª—å£ï¼‰
    â†“
3. âœ¨ SmartContextBuilder.buildSmartContext()
    â†“
    åˆ¤æ–­ chunking-strategy:
    - SIMPLE â†’ SimpleChunkerï¼ˆæŒ‰å›ºå®šé•¿åº¦åˆ‡åˆ†ï¼‰
    - SMART_KEYWORD â†’ SmartKeywordChunkerï¼ˆä¼˜å…ˆä¿ç•™å…³é”®è¯ï¼‰
    - AI_SEMANTIC â†’ AiSemanticChunkerï¼ˆä½¿ç”¨ LLM æ™ºèƒ½åˆ‡åˆ†ï¼‰âœ… è¿™é‡Œï¼
    â†“
4. å°†åˆ‡åˆ†åçš„å†…å®¹æ‹¼æ¥æˆ Prompt
    â†“
5. å‘é€ç»™ LLM è·å–ç­”æ¡ˆ
```

### ğŸ¯ æ ¸å¿ƒç›®çš„

**è§£å†³ LLM ä¸Šä¸‹æ–‡çª—å£é™åˆ¶é—®é¢˜**

- LLM æœ‰æœ€å¤§ä¸Šä¸‹æ–‡é•¿åº¦ï¼ˆå¦‚ DeepSeek 32K tokensï¼‰
- æ£€ç´¢åˆ°çš„æ–‡æ¡£å¯èƒ½è¿œè¶…è¿™ä¸ªé•¿åº¦
- éœ€è¦æ™ºèƒ½åˆ‡åˆ†ï¼Œä¿ç•™æœ€ç›¸å…³çš„å†…å®¹å‘é€ç»™ LLM

### ğŸ’» å®ç°ä»£ç 

**ä½ç½®ï¼š** `SmartContextBuilder.java`

```java
public class SmartContextBuilder {
    
    public String buildSmartContext(String query, List<Document> documents) {
        // ...
        
        // ä½¿ç”¨é…ç½®çš„åˆ‡åˆ†å™¨æå–å†…å®¹
        String relevantPart = extractWithChunker(query, doc.getContent(), allowedLength);
        
        // ...
    }
    
    private String extractWithChunker(String query, String content, int maxLength) {
        if (chunker == null) {
            // é™çº§ï¼šä½¿ç”¨æ™ºèƒ½åˆ†å—ç­–ç•¥
            return extractWithChunking(query, content, maxLength);
        }
        
        // âœ… è¿™é‡Œè°ƒç”¨ ai-chunking é…ç½®çš„åˆ‡åˆ†å™¨
        List<DocumentChunk> chunks = chunker.chunk(content, query);
        
        // é€‰æ‹©æœ€ç›¸å…³çš„å—
        List<DocumentChunk> selectedChunks = selectBestChunks(chunks, maxLength);
        
        // ...
    }
}
```

**åˆ‡åˆ†å™¨å®ç°ï¼š** `AiSemanticChunker.java`

```java
@Override
public List<DocumentChunk> chunk(String content, String query) {
    // æ„å»ºåˆ‡åˆ† Prompt
    String prompt = buildChunkingPrompt(content, query);
    
    // âœ… è°ƒç”¨ LLM è¿›è¡Œæ™ºèƒ½åˆ‡åˆ†
    String response = llmClient.generate(prompt);
    
    // è§£æ JSON å“åº”
    return parseChunkResponse(response, content);
}
```

### âš™ï¸ é…ç½®å»ºè®®

```yaml
# æ¨èé…ç½®ï¼ˆæˆæœ¬ä¼˜åŒ–ï¼‰
llm:
  chunking-strategy: SMART_KEYWORD  # âœ… æ¨èï¼šæ™ºèƒ½å…³é”®è¯åˆ‡åˆ†
  
  chunking:
    ai-chunking:
      enabled: false                 # âš ï¸ AI åˆ‡åˆ†æˆæœ¬é«˜ï¼Œå»ºè®®å…³é—­
```

**åŸå› ï¼š**
- `SMART_KEYWORD` ç­–ç•¥å…è´¹ã€å¿«é€Ÿã€æ•ˆæœè‰¯å¥½
- `AI_SEMANTIC` æ¯æ¬¡é—®ç­”éƒ½è°ƒç”¨ LLMï¼Œè´¹ç”¨è¾ƒé«˜
- é™¤éå¯¹ç²¾åº¦æœ‰æé«˜è¦æ±‚ï¼Œå¦åˆ™ä¸å»ºè®®å¯ç”¨

---

## 2ï¸âƒ£ `knowledge.qa.ppl.chunking.llm-chunking`

### ğŸ“ é…ç½®ä½ç½®

```yaml
knowledge:
  qa:
    ppl:
      chunking:
        # åˆ†å—ç­–ç•¥é€‰æ‹©: ppl, llm, auto
        strategy: ppl                    # âœ… æ¨èï¼šPPL å¿«é€Ÿå…è´¹
        
        # LLM åˆ†å—é…ç½®
        llm-chunking:
          enabled: false                 # âš ï¸ æˆæœ¬è¾ƒé«˜ï¼ŒæŒ‰éœ€å¯ç”¨
          use-main-llm: true
          api-key: ${AI_API_KEY:}
          api-url: https://api.deepseek.com/v1/chat/completions
          model: deepseek-chat
          
          prompt-template: |
            ä½ æ˜¯ä¸€ä¸ªæ–‡æ¡£åˆ†å—ä¸“å®¶ã€‚è¯·å°†ä»¥ä¸‹æ–‡æ¡£æ™ºèƒ½åœ°åˆ†å‰²æˆå¤šä¸ªè¯­ä¹‰å®Œæ•´çš„å—...
```

### â° ä½¿ç”¨æ—¶æœº

**é˜¶æ®µï¼šç´¢å¼•æ—¶ï¼ˆIndex Timeï¼‰**

```
ç”¨æˆ·ä¸Šä¼ æ–‡æ¡£ "äº§å“æ‰‹å†Œ.pdf"
    â†“
1. æ–‡æ¡£è§£æï¼ˆæå–æ–‡æœ¬ã€å›¾ç‰‡ï¼‰
    â†“
2. âœ¨ DocumentPreprocessingService.chunkDocumentWithPPL()
    â†“
    åˆ¤æ–­ ppl.chunking.strategy:
    - ppl â†’ PPLChunkingStrategyï¼ˆåŸºäºå›°æƒ‘åº¦åˆ‡åˆ†ï¼‰âœ… é»˜è®¤
    - llm â†’ LLMChunkingStrategyï¼ˆä½¿ç”¨ LLM åˆ‡åˆ†ï¼‰âœ… è¿™é‡Œï¼
    - auto â†’ è‡ªåŠ¨é€‰æ‹©ï¼ˆä¼˜å…ˆ LLMï¼Œé™çº§ PPLï¼‰
    â†“
3. å°†å®Œæ•´æ–‡æ¡£åˆ‡åˆ†æˆå¤šä¸ªè¯­ä¹‰å—
   ä¾‹å¦‚ï¼š
   - å—1: "äº§å“æ¦‚è¿°ï¼ˆç¬¬1ç« ï¼‰"
   - å—2: "æŠ€æœ¯è§„æ ¼ï¼ˆç¬¬2ç« ï¼‰"
   - å—3: "ä½¿ç”¨è¯´æ˜ï¼ˆç¬¬3ç« ï¼‰"
    â†“
4. æ¯ä¸ªå—å•ç‹¬å»ºç«‹ç´¢å¼•
    â†“
5. å­˜å…¥å‘é‡æ•°æ®åº“å’Œ Lucene ç´¢å¼•
```

### ğŸ¯ æ ¸å¿ƒç›®çš„

**æé«˜æ£€ç´¢ç²¾åº¦å’Œè¯­ä¹‰å®Œæ•´æ€§**

- å°†é•¿æ–‡æ¡£åˆ‡åˆ†æˆè¯­ä¹‰å®Œæ•´çš„å°å—
- æ¯ä¸ªå—å¯¹åº”ä¸€ä¸ªå®Œæ•´çš„ä¸»é¢˜/ç« èŠ‚
- æ£€ç´¢æ—¶èƒ½ç²¾ç¡®åŒ¹é…åˆ°ç›¸å…³ç« èŠ‚
- é¿å…æ£€ç´¢åˆ°ä¸ç›¸å…³çš„å†…å®¹

### ğŸ’» å®ç°ä»£ç 

**ä½ç½®ï¼š** `DocumentPreprocessingService.java`

```java
@Service
public class DocumentPreprocessingService {
    
    public List<Document> chunkDocumentWithPPL(Document document) {
        // è·å–åˆ†å—é…ç½®
        ChunkConfig chunkConfig = pplConfig.getChunking();
        
        // âœ… è¿™é‡Œè°ƒç”¨ ppl.chunking.llm-chunking é…ç½®çš„ç­–ç•¥
        List<DocumentChunk> chunks = pplServiceFacade.chunk(
            document.getContent(),
            null  // query ä¸º nullï¼Œè¡¨ç¤ºé€šç”¨åˆ‡åˆ†
        );
        
        // è½¬æ¢ä¸º Document åˆ—è¡¨
        List<Document> documents = new ArrayList<>();
        for (int i = 0; i < chunks.size(); i++) {
            Document chunkDoc = Document.builder()
                .title(document.getTitle() + " (å—" + (i + 1) + "/" + chunks.size() + ")")
                .content(chunks.get(i).getContent())
                .build();
            
            documents.add(chunkDoc);
        }
        
        return documents;
    }
}
```

**ä½ç½®ï¼š** `KnowledgeBaseService.java`

```java
private List<Document> processDocumentOptimized(File file, ...) {
    // è§£ææ–‡æ¡£
    Document document = parser.parse(file);
    
    List<Document> documentsToIndex = List.of(document);
    
    // âœ… å¦‚æœå¯ç”¨ PPL Chunkingï¼Œè¿›è¡Œæ™ºèƒ½åˆ‡åˆ†
    if (pplServiceFacade != null && 
        pplConfig.getChunking().isEnableCoarseChunking()) {
        try {
            documentsToIndex = preprocessingService.chunkDocumentWithPPL(document);
            log.info("âœ… PPL chunking: {} chunks", documentsToIndex.size());
        } catch (Exception e) {
            log.warn("âš ï¸ PPL chunking failed: {}", e.getMessage());
        }
    }
    
    // ç´¢å¼•æ‰€æœ‰æ–‡æ¡£å—
    for (Document doc : documentsToIndex) {
        rag.index(doc);
    }
    
    return documentsToIndex;
}
```

**åˆ‡åˆ†å™¨å®ç°ï¼š** `LLMChunkingStrategy.java`

```java
@Override
public List<DocumentChunk> chunk(String content, String query, ChunkConfig config) {
    // æ„å»ºæç¤ºè¯ï¼ˆä½¿ç”¨é…ç½®çš„æ¨¡æ¿ï¼‰
    String prompt = promptTemplate
        .replace("{minSize}", String.valueOf(config.getMinChunkSize()))
        .replace("{maxSize}", String.valueOf(config.getMaxChunkSize()))
        .replace("{content}", content);
    
    // âœ… è°ƒç”¨ LLM è¿›è¡Œåˆ†å—åˆ†æ
    String response = llmClient.generate(prompt);
    
    // è§£æå“åº”ï¼Œæ‰¾åˆ° [CHUNK_SPLIT] æ ‡è®°
    return parseChunkSplits(content, response);
}
```

### âš™ï¸ é…ç½®å»ºè®®

```yaml
# æ¨èé…ç½®ï¼ˆæˆæœ¬ä¼˜åŒ–ï¼‰
ppl:
  chunking:
    strategy: ppl                      # âœ… æ¨èï¼šPPL å¿«é€Ÿå…è´¹ç¦»çº¿å¯ç”¨
    
    llm-chunking:
      enabled: false                   # âš ï¸ ä»…åœ¨å¯¹è´¨é‡è¦æ±‚æé«˜æ—¶å¯ç”¨
      
    # PPL é…ç½®ï¼ˆæ¨èï¼‰
    ppl-threshold: 20.0                # å›°æƒ‘åº¦é˜ˆå€¼
    max-chunk-size: 2500               # æœ€å¤§å—å¤§å°
    enable-coarse-chunking: true       # å¯ç”¨ä¸¤é˜¶æ®µåˆ‡åˆ†
```

**åŸå› ï¼š**
- PPL ç­–ç•¥åŸºäºå›°æƒ‘åº¦ï¼Œå¿«é€Ÿã€å…è´¹ã€ç¦»çº¿å¯ç”¨
- LLM ç­–ç•¥è´¨é‡æ›´é«˜ï¼Œä½†æ¯ä¸ªæ–‡æ¡£éƒ½è¦è°ƒç”¨ LLM
- ç´¢å¼•ä¸€æ¬¡æ€§ä»»åŠ¡ï¼Œä½†æ–‡æ¡£å¤šæ—¶è´¹ç”¨ç´¯ç§¯è¾ƒé«˜

---

## ğŸ”„ å®Œæ•´æµç¨‹å¯¹æ¯”

### åœºæ™¯ 1ï¼šç”¨æˆ·ä¸Šä¼ æ–‡æ¡£ â†’ ç´¢å¼•

```yaml
# ä½¿ç”¨ï¼šppl.chunking.llm-chunking âœ…

ä¸Šä¼  "ç”¨æˆ·æ‰‹å†Œ.pdf" (50 é¡µ)
    â†“
è§£ææ–‡æ¡£ â†’ æå– 20000 å­—
    â†“
ã€ç´¢å¼•æ—¶åˆ†å—ã€‘ppl.chunking.llm-chunking
    â†“
è°ƒç”¨ LLMï¼ˆ1æ¬¡ï¼‰ï¼š
  è¾“å…¥: 20000 å­—å®Œæ•´æ–‡æ¡£
  è¾“å‡º: [CHUNK_SPLIT] æ ‡è®°
    â†“
åˆ‡åˆ†æˆ 8 ä¸ªè¯­ä¹‰å—ï¼š
  - å—1: "äº§å“ä»‹ç»" (2500å­—)
  - å—2: "å®‰è£…æŒ‡å—" (2000å­—)
  - å—3: "ä½¿ç”¨è¯´æ˜" (3000å­—)
  - ...
    â†“
æ¯ä¸ªå—å»ºç«‹ç´¢å¼• â†’ å­˜å…¥æ•°æ®åº“
    â†“
âœ… ç´¢å¼•å®Œæˆï¼ˆä»…è°ƒç”¨ LLM 1æ¬¡ï¼‰
```

### åœºæ™¯ 2ï¼šç”¨æˆ·æé—®

```yaml
# ä½¿ç”¨ï¼šllm.chunking.ai-chunking âœ…

ç”¨æˆ·æé—®: "å¦‚ä½•å®‰è£…ï¼Ÿ"
    â†“
æ£€ç´¢ç›¸å…³æ–‡æ¡£å—
    â†“
å‘½ä¸­ 3 ä¸ªå—ï¼ˆå…± 7500 å­—ï¼‰ï¼š
  - å—2: "å®‰è£…æŒ‡å—" (2000å­—)
  - å—5: "æ•…éšœæ’é™¤" (2500å­—)
  - å—6: "å¸¸è§é—®é¢˜" (3000å­—)
    â†“
ã€é—®ç­”æ—¶åˆ†å—ã€‘llm.chunking.ai-chunking
    â†“
è°ƒç”¨ LLMï¼ˆ1æ¬¡ï¼‰æ™ºèƒ½åˆ‡åˆ†ï¼š
  è¾“å…¥: 7500 å­— + query "å¦‚ä½•å®‰è£…ï¼Ÿ"
  è¾“å‡º: ä¿ç•™æœ€ç›¸å…³çš„ 4000 å­—
    â†“
æ‹¼æ¥ Prompt:
  ä¸Šä¸‹æ–‡: 4000 å­—ç²¾ç®€å†…å®¹
  é—®é¢˜: "å¦‚ä½•å®‰è£…ï¼Ÿ"
    â†“
è°ƒç”¨ LLMï¼ˆç¬¬2æ¬¡ï¼‰ç”Ÿæˆç­”æ¡ˆ
    â†“
âœ… è¿”å›ç­”æ¡ˆï¼ˆå…±è°ƒç”¨ LLM 2æ¬¡ï¼‰
```

---

## ğŸ’° æˆæœ¬åˆ†æ

### ç´¢å¼•é˜¶æ®µï¼ˆä¸€æ¬¡æ€§ï¼‰

```
å‡è®¾ï¼š100 ä¸ªæ–‡æ¡£ï¼Œæ¯ä¸ª 10000 å­—

# ä½¿ç”¨ ppl.chunking.llm-chunking
- è°ƒç”¨æ¬¡æ•°: 100 æ¬¡
- è¾“å…¥ tokens: 100 Ã— 10000 = 1,000,000 å­— â‰ˆ 750K tokens
- è¾“å‡º tokens: 100 Ã— 200 = 20K tokens
- è´¹ç”¨ï¼ˆDeepSeekï¼‰: (750K Ã— $0.14/M) + (20K Ã— $0.28/M) â‰ˆ $0.11

# ä½¿ç”¨ ppl.chunking.pplï¼ˆæ¨èï¼‰
- è°ƒç”¨æ¬¡æ•°: 0 æ¬¡
- è´¹ç”¨: $0 âœ…
```

### é—®ç­”é˜¶æ®µï¼ˆæ¯æ¬¡é—®ç­”ï¼‰

```
å‡è®¾ï¼šæ¯å¤© 100 æ¬¡é—®ç­”ï¼Œæ¯æ¬¡æ£€ç´¢ 3 ä¸ªæ–‡æ¡£å—ï¼ˆ7500 å­—ï¼‰

# ä½¿ç”¨ llm.chunking.ai-chunking
- è°ƒç”¨æ¬¡æ•°: 100 æ¬¡/å¤©
- è¾“å…¥ tokens: 100 Ã— 7500 = 750,000 å­— â‰ˆ 560K tokens/å¤©
- è´¹ç”¨ï¼ˆDeepSeekï¼‰: 560K Ã— $0.14/M â‰ˆ $0.08/å¤© â†’ $2.4/æœˆ

# ä½¿ç”¨ llm.chunking.SMART_KEYWORDï¼ˆæ¨èï¼‰
- è°ƒç”¨æ¬¡æ•°: 0 æ¬¡/å¤©
- è´¹ç”¨: $0/æœˆ âœ…
```

---

## âœ… æœ€ä½³å®è·µå»ºè®®

### æ¨èé…ç½®ï¼ˆæ€§ä»·æ¯”æœ€é«˜ï¼‰

```yaml
knowledge:
  qa:
    # é—®ç­”æ—¶åˆ‡åˆ†ç­–ç•¥
    llm:
      chunking-strategy: SMART_KEYWORD   # âœ… å…è´¹ã€å¿«é€Ÿã€æ•ˆæœå¥½
      chunking:
        ai-chunking:
          enabled: false                  # å…³é—­ AI åˆ‡åˆ†
    
    # ç´¢å¼•æ—¶åˆ‡åˆ†ç­–ç•¥
    ppl:
      chunking:
        strategy: ppl                     # âœ… å…è´¹ã€å¿«é€Ÿã€ç¦»çº¿å¯ç”¨
        llm-chunking:
          enabled: false                  # å…³é—­ LLM åˆ‡åˆ†
        
        # PPL é…ç½®
        ppl-threshold: 20.0
        max-chunk-size: 2500
        enable-coarse-chunking: true
```

### é«˜è´¨é‡é…ç½®ï¼ˆé€‚åˆè¦æ±‚æé«˜çš„åœºæ™¯ï¼‰

```yaml
knowledge:
  qa:
    # é—®ç­”æ—¶åˆ‡åˆ†ç­–ç•¥
    llm:
      chunking-strategy: AI_SEMANTIC     # âš ï¸ é«˜æˆæœ¬
      chunking:
        ai-chunking:
          enabled: true                   # å¯ç”¨ AI åˆ‡åˆ†
          model: gpt-4o                   # ä½¿ç”¨é«˜è´¨é‡æ¨¡å‹
    
    # ç´¢å¼•æ—¶åˆ‡åˆ†ç­–ç•¥
    ppl:
      chunking:
        strategy: llm                     # âš ï¸ é«˜æˆæœ¬
        llm-chunking:
          enabled: true                   # å¯ç”¨ LLM åˆ‡åˆ†
          model: gpt-4o                   # ä½¿ç”¨é«˜è´¨é‡æ¨¡å‹
```

### æ··åˆé…ç½®ï¼ˆå¹³è¡¡æˆæœ¬ä¸è´¨é‡ï¼‰

```yaml
knowledge:
  qa:
    # é—®ç­”æ—¶åˆ‡åˆ†ç­–ç•¥
    llm:
      chunking-strategy: SMART_KEYWORD   # âœ… å…è´¹å¿«é€Ÿ
      
    # ç´¢å¼•æ—¶åˆ‡åˆ†ç­–ç•¥
    ppl:
      chunking:
        strategy: llm                     # âš ï¸ å¯ç”¨ LLM åˆ‡åˆ†
        llm-chunking:
          enabled: true
          model: deepseek-chat            # ä½¿ç”¨ç»æµæ¨¡å‹
```

**é€‚ç”¨åœºæ™¯ï¼š**
- ç´¢å¼•è´¨é‡è¦æ±‚é«˜ï¼ˆæ–‡æ¡£å¾ˆé‡è¦ï¼‰
- é—®ç­”é¢‘ç¹ï¼ˆå¸Œæœ›é™ä½é—®ç­”æˆæœ¬ï¼‰
- ç´¢å¼•æ˜¯ä¸€æ¬¡æ€§çš„ï¼ˆå¯æ¥å—å‰æœŸæˆæœ¬ï¼‰

---

## ğŸ“Š å†³ç­–æ ‘

```
éœ€è¦é«˜è´¨é‡åˆ‡åˆ†å—ï¼Ÿ
    â”‚
    â”œâ”€ æ˜¯ â†’ åœ¨å“ªä¸ªé˜¶æ®µï¼Ÿ
    â”‚       â”‚
    â”‚       â”œâ”€ ç´¢å¼•æ—¶ â†’ ä½¿ç”¨ ppl.chunking.llm-chunking
    â”‚       â”‚           ï¼ˆä¸€æ¬¡æ€§æˆæœ¬ï¼Œé•¿æœŸå—ç›Šï¼‰
    â”‚       â”‚
    â”‚       â””â”€ é—®ç­”æ—¶ â†’ ä½¿ç”¨ llm.chunking.ai-chunking
    â”‚                   ï¼ˆæ¯æ¬¡é—®ç­”éƒ½æœ‰æˆæœ¬ï¼‰
    â”‚
    â””â”€ å¦ â†’ ä½¿ç”¨å…è´¹ç­–ç•¥
            â”œâ”€ ç´¢å¼•æ—¶ï¼šppl.chunking.strategy = ppl âœ…
            â””â”€ é—®ç­”æ—¶ï¼šllm.chunking-strategy = SMART_KEYWORD âœ…
```

---

## ğŸ¯ æ€»ç»“

| é…ç½®é¡¹ | ä½¿ç”¨æ—¶æœº | ä½œç”¨ä½ç½® | è°ƒç”¨é¢‘ç‡ | æ¨èç­–ç•¥ |
|--------|---------|---------|---------|---------|
| **llm.chunking.ai-chunking** | é—®ç­”æ—¶ | SmartContextBuilder | æ¯æ¬¡é—®ç­” | âŒ å…³é—­ï¼ˆä½¿ç”¨ SMART_KEYWORDï¼‰|
| **ppl.chunking.llm-chunking** | ç´¢å¼•æ—¶ | DocumentPreprocessingService | æ¯ä¸ªæ–‡æ¡£ä¸€æ¬¡ | âš ï¸ æŒ‰éœ€å¯ç”¨ï¼ˆé»˜è®¤ä½¿ç”¨ PPLï¼‰|

**æ ¸å¿ƒåŸåˆ™ï¼š**
1. **ç´¢å¼•æ—¶**å¯ä»¥æ‰¿å—ä¸€å®šæˆæœ¬ï¼Œå› ä¸ºæ˜¯ä¸€æ¬¡æ€§çš„
2. **é—®ç­”æ—¶**è¦æ§åˆ¶æˆæœ¬ï¼Œå› ä¸ºè°ƒç”¨é¢‘ç¹
3. ä¼˜å…ˆä½¿ç”¨**å…è´¹ç­–ç•¥**ï¼ˆPPLã€SMART_KEYWORDï¼‰
4. åªåœ¨**è´¨é‡è¦æ±‚æé«˜**æ—¶æ‰å¯ç”¨ LLM

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0  
**æœ€åæ›´æ–°ï¼š** 2025-12-07

