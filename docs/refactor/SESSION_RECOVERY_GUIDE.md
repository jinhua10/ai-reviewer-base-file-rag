# Session 恢复指南 (Session Recovery Guide)
# 如何在新 Session 中继续 RAG 2.0 开发

> **文档编号**: SESSION_RECOVERY_GUIDE  
> **创建日期**: 2025-12-09  
> **用途**: 帮助在新 Copilot Session 中快速恢复工作进度

---

## 🎯 快速恢复（30秒内）

### 如果你刚打开一个新的 Copilot Session：

**只需说一句话**：
```
"查看 refactor 目录中最新的实施计划文档，继续未完成的任务"
```

或者更精确地：
```
"查看 20251209-22-29-00-IMPLEMENTATION_PLAN.md，从上次中断的地方继续"
```

**Copilot 会自动**：
1. ✅ 读取最新的实施计划文档
2. ✅ 找到"当前进度"和"下一步"
3. ✅ 加载相关的设计文档
4. ✅ 开始执行下一个任务
5. ✅ 完成后更新进度状态

---

## 📂 文档组织规范

### refactor 目录结构
```
docs/refactor/
├── 20251209-22-29-00-IMPLEMENTATION_PLAN.md    (主实施计划)
├── 20251209-HH-mm-ss-Phase1-Role-Model.md      (Phase 1 详细文档)
├── 20251209-HH-mm-ss-Phase2-Vector-Index.md    (Phase 2 详细文档)
├── ...
└── SESSION_RECOVERY_GUIDE.md                    (本文档)
```

### 文档命名规范
```
格式: yyyyMMdd-HH-mm-ss-{描述}.md

示例:
- 20251209-22-29-00-IMPLEMENTATION_PLAN.md
- 20251210-14-30-00-Phase1-Complete-Report.md
- 20251211-09-15-00-Bug-Fix-Vector-Index.md

规则:
1. 时间戳前缀便于排序和追溯
2. 描述部分使用英文，用短横线分隔
3. 所有重要文档都放在 refactor 目录
```

---

## 🔄 会话恢复流程

### 场景 1: 短时间中断（<1天）

**情况**: 刚才还在开发，电脑重启/网络断开/Copilot 刷新

**恢复步骤**:
1. 打开 `refactor` 目录
2. 找到最新的实施计划文档
3. 告诉 Copilot: "继续上次的任务"
4. Copilot 读取进度，直接开始

**预计恢复时间**: 1-2 分钟

---

### 场景 2: 长时间中断（>1天）

**情况**: 昨天做到一半，今天继续

**恢复步骤**:
1. 打开最新的实施计划文档
2. 查看"进度更新日志"部分
3. 查看"当前进度"和"下一步"
4. 告诉 Copilot: 
   ```
   "查看 20251209-22-29-00-IMPLEMENTATION_PLAN.md，
   上次进行到 Phase X.Y，现在继续完成"
   ```
5. Copilot 会：
   - 回顾上次完成的内容
   - 检查是否有编译错误
   - 继续未完成的任务

**预计恢复时间**: 3-5 分钟

---

### 场景 3: 跨版本恢复（代码已更新）

**情况**: 别人改了代码，或者自己手动修改了代码

**恢复步骤**:
1. 告诉 Copilot:
   ```
   "先检查代码是否有变更，然后根据实施计划继续"
   ```
2. Copilot 会：
   - 检查 git diff
   - 检查编译错误
   - 评估是否需要调整计划
   - 继续或调整任务

**预计恢复时间**: 5-10 分钟

---

## 📋 每次 Session 结束前的检查清单

### 开发者自己做：

- [ ] **保存所有文件**
- [ ] **编译验证** (`mvn compile`)
- [ ] **提交代码** (`git add . && git commit -m "Phase X.Y 完成"`)
- [ ] **更新进度** (修改实施计划文档的"当前进度")
- [ ] **记录问题** (如果有未解决的问题，记录在"进度更新日志")

### 让 Copilot 做：

```
"总结本次 Session 的工作，更新实施计划文档的进度"
```

Copilot 会：
1. ✅ 总结完成的任务
2. ✅ 更新"当前进度"
3. ✅ 更新"进度更新日志"
4. ✅ 标注"下一步"
5. ✅ 生成本次工作的总结文档

---

## 🎯 常见恢复场景示例

### 示例 1: 基础恢复

**你说**:
```
"继续 RAG 2.0 的开发"
```

**Copilot 会**:
```
1. 查找 refactor 目录中最新的实施计划
2. 读取"当前进度"
3. 显示上次进度：
   "上次进行到 Phase 1.1 - 角色模型与配置，已完成 Role.java，
    下一步需要创建 RoleConfig.java"
4. 询问: "是否继续创建 RoleConfig.java？"
5. 得到确认后开始执行
```

---

### 示例 2: 带上下文的恢复

**你说**:
```
"查看实施计划，上次做到 Phase 1.2，现在继续"
```

**Copilot 会**:
```
1. 打开 20251209-22-29-00-IMPLEMENTATION_PLAN.md
2. 跳转到 Phase 1.2 部分
3. 检查任务清单：
   - [x] 扩展 ConceptUnit 类
   - [ ] 创建 ConceptVersion 实体  ← 这里中断了
   - [ ] 创建 ConceptHistory 实体
   - [ ] 实现版本管理服务
4. 显示: "Phase 1.2 已完成第 1 项，现在继续第 2 项：创建 ConceptVersion 实体"
5. 开始创建 ConceptVersion.java
```

---

### 示例 3: 跨天恢复

**你说**:
```
"昨天做到 Phase 2，今天继续，先检查一下代码状态"
```

**Copilot 会**:
```
1. 读取实施计划
2. 检查 Phase 2 的完成状态
3. 运行 `mvn compile` 检查编译
4. 运行 `git status` 检查未提交的更改
5. 显示状态报告：
   "Phase 2 - 角色知识库
    - Phase 2.1: 角色检测器 ✅ 已完成
    - Phase 2.2: 分角色向量索引 🔄 进行中 (60%)
    - Phase 2.3: 按需加载器 ⏰ 未开始
    
    编译状态: ✅ 通过
    未提交更改: 3 个文件
    
    建议: 先提交当前更改，然后继续 Phase 2.2"
6. 等待你的指令
```

---

## 🛠️ 实用命令速查

### 快速恢复
```
"继续 RAG 2.0 开发"
"查看实施计划，从上次中断的地方继续"
"Phase X.Y 继续"
```

### 检查状态
```
"查看当前开发进度"
"检查 Phase X 的完成情况"
"列出未完成的任务"
```

### 回顾历史
```
"总结 Phase X 做了什么"
"显示最近的进度更新日志"
"Phase X 有哪些问题"
```

### 调整计划
```
"Phase X.Y 太复杂，拆分成更小的任务"
"Phase X 优先级降低，先做 Phase Y"
"Phase X 遇到问题，记录并跳过"
```

---

## 📊 进度追踪最佳实践

### 每完成一个小任务
```
- [ ] 任务名称  →  - [x] 任务名称 ✅ 2025-12-09 14:30
```

### 每完成一个 Phase
```yaml
生成完成报告:
  - 文档名: yyyyMMdd-HH-mm-ss-PhaseX-Complete-Report.md
  - 内容:
    - 完成的功能
    - 代码统计
    - 测试结果
    - 遇到的问题
    - 下一步建议
```

### 每天结束时
```yaml
更新主实施计划:
  - 当前进度
  - 今日完成
  - 明日计划
  - 风险提示
```

---

## 🚨 故障排查

### 问题 1: Copilot 找不到实施计划

**原因**: 文档名称或路径错误

**解决**:
```
"打开 docs/refactor 目录，列出所有文档"
"查看最新的实施计划文档（文件名包含 IMPLEMENTATION_PLAN）"
```

---

### 问题 2: 进度信息过期

**原因**: 上次忘记更新进度

**解决**:
```
"根据 git log 和代码变更，推断当前实际进度"
"更新实施计划文档的进度状态"
```

---

### 问题 3: 任务清单不清晰

**原因**: 任务描述太模糊

**解决**:
```
"细化 Phase X.Y 的任务清单，拆分成更小的步骤"
"为每个任务添加明确的验收标准"
```

---

## 💡 高级技巧

### 技巧 1: 并行开发

**场景**: 多人协作，或者同时开发多个 Phase

**做法**:
```
每个 Phase 创建独立的分支:
  - git checkout -b feature/phase-1
  - git checkout -b feature/phase-2
  
每个 Phase 有独立的进度文档:
  - 20251209-xx-xx-Phase1-Progress.md
  - 20251210-xx-xx-Phase2-Progress.md
  
定期合并:
  - git merge feature/phase-1
  - 解决冲突
  - 更新主实施计划
```

---

### 技巧 2: 快照备份

**场景**: 重大变更前，做一个快照

**做法**:
```
"创建当前状态的快照文档"

Copilot 会生成:
  - 20251209-HH-mm-ss-Snapshot-Before-Phase-X.md
  - 包含:
    - 当前代码状态
    - 编译结果
    - 测试结果
    - 配置文件
    - 数据库状态
```

---

### 技巧 3: 自动进度报告

**场景**: 每周生成一次进度报告

**做法**:
```
"生成本周进度报告"

Copilot 会:
  1. 分析 git log
  2. 分析进度更新日志
  3. 统计代码变更
  4. 生成周报：
     - 20251209-Weekly-Report.md
     - 包含:
       - 本周完成的任务
       - 代码统计
       - 问题清单
       - 下周计划
```

---

## 📚 相关文档索引

```yaml
核心文档:
  - 20251209-22-29-00-IMPLEMENTATION_PLAN.md (主实施计划)
  - SESSION_RECOVERY_GUIDE.md (本文档)
  
设计文档:
  - HIERARCHICAL_SEMANTIC_RAG.md (知识演化系统设计)
  - ROLE_BASED_KNOWLEDGE_ARCHITECTURE.md (分角色知识库设计)
  
历史文档:
  - PHASE_MINUS_1_FINAL_REPORT.md (Phase -1 完成报告)
  - P2_TASKS_COMPLETION_REPORT.md (P2 任务报告)
```

---

## ✅ 检查清单

### 新 Session 开始前
- [ ] 查看最新实施计划
- [ ] 查看进度更新日志
- [ ] 检查是否有未解决的问题
- [ ] 确认下一步任务

### 开发过程中
- [ ] 每完成一个小任务，更新进度
- [ ] 每遇到问题，记录在日志中
- [ ] 每小时保存一次代码
- [ ] 定期运行编译和测试

### Session 结束前
- [ ] 保存所有文件
- [ ] 编译验证
- [ ] 提交代码
- [ ] 更新进度
- [ ] 记录下一步

---

**记住：好的文档组织 = 高效的协作 = 快速的开发！** 📝✨

---

**文档版本**: v1.0  
**创建日期**: 2025-12-09  
**最后更新**: 2025-12-09  
**维护者**: AI Reviewer Team

