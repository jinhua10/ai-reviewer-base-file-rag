# ğŸš€ AI Reviewer Base File RAG - éƒ¨ç½²æŒ‡å—

> **ä¼ä¸šçº§æœ¬åœ°æ–‡ä»¶ RAG æ£€ç´¢ç³»ç»Ÿ**  
> é›¶å¤–éƒ¨ä¾èµ– | æˆæœ¬èŠ‚çº¦ 77% | æ•°æ® 100% éšç§ä¿æŠ¤

[![Version](https://img.shields.io/badge/version-1.0-blue.svg)](https://github.com/jinhua10/ai-reviewer-base-file-rag)
[![License](https://img.shields.io/badge/license-Apache%202.0-green.svg)](../LICENSE.txt)

[English](README_EN.md) | ç®€ä½“ä¸­æ–‡

---

## ğŸ“‹ ç›®å½•

- [ç‰ˆæœ¬ç‰¹æ€§](#-ç‰ˆæœ¬ç‰¹æ€§)
- [å¿«é€Ÿå¼€å§‹](#-å¿«é€Ÿå¼€å§‹-3åˆ†é’Ÿéƒ¨ç½²)
- [ç›®å½•ç»“æ„](#-ç›®å½•ç»“æ„)
- [é…ç½®è¯´æ˜](#ï¸-é…ç½®è¯´æ˜)
- [API ä½¿ç”¨](#-api-ä½¿ç”¨)
- [å¸¸è§é—®é¢˜](#-å¸¸è§é—®é¢˜)
- [æ€§èƒ½ä¼˜åŒ–](#-æ€§èƒ½ä¼˜åŒ–)
- [æŠ€æœ¯æ”¯æŒ](#-æŠ€æœ¯æ”¯æŒ)

---

## âœ¨ ç‰ˆæœ¬ç‰¹æ€§

### v1.0 æ ¸å¿ƒåŠŸèƒ½

| åŠŸèƒ½ | è¯´æ˜ | çŠ¶æ€ |
|------|------|------|
| **35+ æ–‡æ¡£æ ¼å¼** | PDF, DOCX, XLSX, PPTX, TXT, MD ç­‰ | âœ… |
| **OCR å›¾ç‰‡è¯†åˆ«** | è‡ªåŠ¨æå–æ–‡æ¡£ä¸­å›¾ç‰‡çš„æ–‡å­—å†…å®¹ | âœ… |
| **BM25 å…³é”®è¯æ£€ç´¢** | é«˜æ€§èƒ½å…¨æ–‡æ£€ç´¢ï¼Œæ— éœ€å‘é‡æ•°æ®åº“ | âœ… |
| **å‘é‡è¯­ä¹‰æ£€ç´¢** | å¯é€‰ ONNX æœ¬åœ°æ¨¡å‹ï¼Œæ”¯æŒè¯­ä¹‰æœç´¢ | âœ… |
| **å¤š LLM æ”¯æŒ** | OpenAI, DeepSeek, Claudeï¼ˆå¯é€‰ï¼‰ | âœ… |
| **REST API** | æ ‡å‡† HTTP æ¥å£ï¼Œæ˜“äºé›†æˆ | âœ… |
| **Spring Boot** | ä¼ä¸šçº§æ¡†æ¶ï¼Œç”Ÿäº§å°±ç»ª | âœ… |

### ğŸ†• æœ€æ–°æ›´æ–°

- âœ… **OCR å›¾ç‰‡è¯†åˆ«å¢å¼º** - æ”¯æŒä¸­è‹±æ–‡æ··åˆè¯†åˆ«
- âœ… **PDFBox å…¼å®¹æ€§ä¿®å¤** - è§£å†³ PDF è§£æé—®é¢˜
- âœ… **å¢å¼ºæ—¥å¿—è¾“å‡º** - æ¸…æ™°çš„å¤„ç†çŠ¶æ€å±•ç¤º
- âœ… **ä¸€é”®è¯Šæ–­å·¥å…·** - `check-ocr.bat` å¿«é€Ÿæ£€æŸ¥é…ç½®

---

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼ˆ3åˆ†é’Ÿéƒ¨ç½²ï¼‰

### å‰ç½®è¦æ±‚

| è½¯ä»¶ | ç‰ˆæœ¬è¦æ±‚ | ä¸‹è½½åœ°å€ |
|------|----------|----------|
| **Java** | 17+ | [Oracle JDK](https://www.oracle.com/java/technologies/downloads/) |
| **å†…å­˜** | 2GB+ | - |
| **ç£ç›˜** | 5GB+ | - |

### æ­¥éª¤ 1: éªŒè¯ Java ç¯å¢ƒ

```bash
java -version
```

åº”æ˜¾ç¤ºç±»ä¼¼è¾“å‡ºï¼š
```
java version "17.0.x"
```

### æ­¥éª¤ 2: å‡†å¤‡æ–‡æ¡£

å°†è¦ç´¢å¼•çš„æ–‡æ¡£æ”¾åˆ° `data/documents/` ç›®å½•ï¼š

```
data/documents/
â”œâ”€â”€ äº§å“æ‰‹å†Œ.pdf
â”œâ”€â”€ æŠ€æœ¯æ–‡æ¡£.docx
â”œâ”€â”€ æ•°æ®æŠ¥è¡¨.xlsx
â”œâ”€â”€ æ¼”ç¤ºæ–‡ç¨¿.pptx
â””â”€â”€ README.md
```

**æ”¯æŒçš„æ–‡æ¡£æ ¼å¼**:

| ç±»åˆ« | æ ¼å¼ |
|------|------|
| **åŠå…¬æ–‡æ¡£** | `.pdf`, `.doc`, `.docx`, `.xls`, `.xlsx`, `.ppt`, `.pptx` |
| **æ–‡æœ¬æ–‡ä»¶** | `.txt`, `.md`, `.csv`, `.json`, `.xml` |
| **ä»£ç æ–‡ä»¶** | `.java`, `.py`, `.js`, `.go`, `.cpp` |
| **å›¾ç‰‡æ–‡ä»¶** | `.png`, `.jpg`, `.jpeg` (éœ€å¯ç”¨ OCR) |

### æ­¥éª¤ 3: ï¼ˆå¯é€‰ï¼‰å¯ç”¨ OCR

å¦‚æœæ–‡æ¡£åŒ…å«å›¾ç‰‡æˆ–æ‰«æä»¶ï¼š

```bash
# ä¸‹è½½ OCR è¯­è¨€åŒ…ï¼ˆä»…éœ€ä¸€æ¬¡ï¼Œçº¦ 10MBï¼‰
download-tessdata.bat
```

> ğŸ’¡ **æç¤º**: OCR å·²é»˜è®¤å¯ç”¨ï¼Œä¸‹è½½è¯­è¨€åŒ…åå³å¯ä½¿ç”¨  
> ğŸ“– è¯¦ç»†è¯´æ˜: [å¿«é€Ÿå¯åŠ¨-OCR.md](å¿«é€Ÿå¯åŠ¨-OCR.md)

### æ­¥éª¤ 4: å¯åŠ¨åº”ç”¨

**Windows ç³»ç»Ÿ**:
```bash
# åŒå‡»è¿è¡Œ
start.bat

# æˆ–å‘½ä»¤è¡Œ
.\start.bat
```

**Linux/Mac ç³»ç»Ÿ**:
```bash
chmod +x start.sh
./start.sh
```

### æ­¥éª¤ 5: éªŒè¯è¿è¡Œ

å¯åŠ¨æˆåŠŸåï¼ˆçº¦ 10-30 ç§’ï¼‰ï¼Œè®¿é—®ï¼š

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/api/qa/health

# æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
curl http://localhost:8080/api/qa/statistics
```

**é¢„æœŸè¾“å‡º**:
```json
{
  "status": "UP",
  "message": "çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿè¿è¡Œæ­£å¸¸"
}
```

---

## ğŸ“¦ ç›®å½•ç»“æ„

```
release/
â”œâ”€â”€ ğŸ“„ ai-reviewer-base-file-rag-1.0.jar    # åº”ç”¨ JAR åŒ…
â”‚
â”œâ”€â”€ ğŸš€ å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ start.bat                            # Windows å¯åŠ¨è„šæœ¬
â”‚   â”œâ”€â”€ stop.bat                             # Windows åœæ­¢è„šæœ¬
â”‚   â””â”€â”€ fix-lock.bat                         # ä¿®å¤ç´¢å¼•é”è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ”§ å·¥å…·è„šæœ¬
â”‚   â”œâ”€â”€ download-tessdata.bat                # OCR è¯­è¨€åŒ…ä¸‹è½½
â”‚   â”œâ”€â”€ check-ocr.bat                        # OCR é…ç½®æ£€æŸ¥
â”‚   â””â”€â”€ download model.bat                   # å‘é‡æ¨¡å‹ä¸‹è½½ï¼ˆmodels/ç›®å½•ï¼‰
â”‚
â”œâ”€â”€ ğŸ“– æ–‡æ¡£
â”‚   â”œâ”€â”€ README.md                            # æœ¬æ–‡ä»¶ï¼ˆéƒ¨ç½²æŒ‡å—ï¼‰
â”‚   â”œâ”€â”€ å¿«é€Ÿå¯åŠ¨-OCR.md                      # OCR å¿«é€Ÿå¯åŠ¨æŒ‡å— â­
â”‚   â”œâ”€â”€ å›¾ç‰‡è¯†åˆ«å¿«é€Ÿå¯ç”¨.md                  # OCR å®Œæ•´ä½¿ç”¨æŒ‡å—
â”‚   â”œâ”€â”€ æ¨¡å‹ä¸‹è½½è¯´æ˜.md                      # å‘é‡æ¨¡å‹ä¸‹è½½æŒ‡å—
â”‚   â”œâ”€â”€ OCRé…ç½®æŒ‡å—.md                       # OCR è¯¦ç»†é…ç½®
â”‚   â”œâ”€â”€ OCRè¯Šæ–­æŒ‡å—.md                       # OCR é—®é¢˜æ’æŸ¥
â”‚   â””â”€â”€ é”æ–‡ä»¶é—®é¢˜è§£å†³æŒ‡å—.md                # ç´¢å¼•é”é—®é¢˜å¤„ç†
â”‚
â”œâ”€â”€ âš™ï¸ config/
â”‚   â””â”€â”€ application.yml                      # å¤–ç½®é…ç½®æ–‡ä»¶
â”‚
â”œâ”€â”€ ğŸ“¦ models/                               # å‘é‡æ¨¡å‹ç›®å½•ï¼ˆå¯é€‰ï¼‰
â”‚   â”œâ”€â”€ download model.bat                   # æ¨¡å‹ä¸‹è½½è„šæœ¬
â”‚   â””â”€â”€ paraphrase-multilingual/             # æ¨¡å‹æ–‡ä»¶
â”‚       â””â”€â”€ model.onnx                       # ONNX æ¨¡å‹ï¼ˆçº¦ 420MBï¼‰
â”‚
â”œâ”€â”€ ğŸ”¤ tessdata/                             # OCR è¯­è¨€åŒ…ç›®å½•
â”‚   â”œâ”€â”€ chi_sim.traineddata                  # ä¸­æ–‡ç®€ä½“ï¼ˆçº¦ 4MBï¼‰
â”‚   â””â”€â”€ eng.traineddata                      # è‹±æ–‡ï¼ˆçº¦ 5MBï¼‰
â”‚
â”œâ”€â”€ ğŸ“ data/                                 # æ•°æ®ç›®å½•
â”‚   â”œâ”€â”€ documents/                           # ğŸ“„ æ”¾ç½®è¦ç´¢å¼•çš„æ–‡æ¡£
â”‚   â”œâ”€â”€ knowledge-base/                      # ğŸ—„ï¸ çŸ¥è¯†åº“å­˜å‚¨ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â”‚   â”œâ”€â”€ documents/                       # æ–‡æ¡£å‰¯æœ¬
â”‚   â”‚   â”œâ”€â”€ index/                           # Lucene ç´¢å¼•
â”‚   â”‚   â”œâ”€â”€ metadata/                        # å…ƒæ•°æ®ï¼ˆSQLiteï¼‰
â”‚   â”‚   â””â”€â”€ cache/                           # ç¼“å­˜æ•°æ®
â”‚   â””â”€â”€ vector-index/                        # ğŸ”¢ å‘é‡ç´¢å¼•ï¼ˆå¯é€‰ï¼Œè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚
â”œâ”€â”€ ğŸ“ logs/                                 # æ—¥å¿—ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
â”‚   â””â”€â”€ ai-reviewer-rag.log                  # åº”ç”¨æ—¥å¿—
â”‚
â””â”€â”€ ğŸ”§ temp/                                 # ä¸´æ—¶æ–‡ä»¶ç›®å½•ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
    â””â”€â”€ work/
```

### ç›®å½•è¯´æ˜

| ç›®å½•/æ–‡ä»¶ | ç”¨é€” | æ˜¯å¦å¿…éœ€ |
|----------|------|----------|
| **ai-reviewer-base-file-rag-1.0.jar** | åº”ç”¨ä¸»ç¨‹åº | âœ… å¿…éœ€ |
| **config/application.yml** | é…ç½®æ–‡ä»¶ | âœ… å¿…éœ€ |
| **data/documents/** | å­˜æ”¾è¦ç´¢å¼•çš„æ–‡æ¡£ | âœ… å¿…éœ€ |
| **tessdata/** | OCR è¯­è¨€åŒ… | âš ï¸ ä½¿ç”¨ OCR æ—¶å¿…éœ€ |
| **models/** | å‘é‡æ£€ç´¢æ¨¡å‹ | âš ï¸ å¯ç”¨å‘é‡æ£€ç´¢æ—¶å¿…éœ€ |
| **data/knowledge-base/** | çŸ¥è¯†åº“ç´¢å¼• | ğŸ”„ è‡ªåŠ¨ç”Ÿæˆ |
| **logs/** | åº”ç”¨æ—¥å¿— | ğŸ”„ è‡ªåŠ¨ç”Ÿæˆ |

---

## âš™ï¸ é…ç½®è¯´æ˜

### é»˜è®¤é…ç½®ï¼ˆå¼€ç®±å³ç”¨ï¼‰

ç³»ç»Ÿé»˜è®¤ä½¿ç”¨ä»¥ä¸‹é…ç½®ï¼Œæ— éœ€ä¿®æ”¹å³å¯å¯åŠ¨ï¼š

```yaml
# é»˜è®¤ç«¯å£
server.port: 8080

# å…³é”®è¯æ£€ç´¢æ¨¡å¼ï¼ˆæ— éœ€ä¸‹è½½æ¨¡å‹ï¼‰
knowledge.qa.vector-search.enabled: false

# æ¨¡æ‹Ÿ LLMï¼ˆæ— éœ€ API Keyï¼‰
knowledge.qa.llm.provider: mock

# OCR å·²å¯ç”¨ï¼ˆéœ€ä¸‹è½½è¯­è¨€åŒ…ï¼‰
# è¿è¡Œ download-tessdata.bat å³å¯
```

### å¸¸ç”¨é…ç½®ä¿®æ”¹

ç¼–è¾‘ `config/application.yml` æ–‡ä»¶ï¼š

#### 1. ä¿®æ”¹æœåŠ¡ç«¯å£

```yaml
server:
  port: 9090  # æ”¹ä¸ºå…¶ä»–ç«¯å£
```

#### 2. é…ç½®æ–‡æ¡£è·¯å¾„

```yaml
knowledge:
  qa:
    knowledge-base:
      # æ–‡æ¡£æºè·¯å¾„ï¼ˆæ”¯æŒç›¸å¯¹/ç»å¯¹è·¯å¾„ï¼‰
      source-path: ./data/documents
      
      # æ˜¯å¦å¯åŠ¨æ—¶é‡å»ºç´¢å¼•
      rebuild-on-startup: false  # false=å¢é‡ï¼Œtrue=å®Œå…¨é‡å»º
```

#### 3. å¯ç”¨å‘é‡æ£€ç´¢ï¼ˆè¯­ä¹‰æœç´¢ï¼‰

âš ï¸ **å‰ç½®æ¡ä»¶**: éœ€å…ˆä¸‹è½½æ¨¡å‹ï¼ˆçº¦ 420MBï¼‰

```bash
# ä¸‹è½½æ¨¡å‹ï¼ˆè¿è¡Œä¸€æ¬¡ï¼‰
cd models
download model.bat
```

ç„¶åä¿®æ”¹é…ç½®ï¼š

```yaml
knowledge:
  qa:
    vector-search:
      enabled: true  # å¯ç”¨å‘é‡æ£€ç´¢
      model:
        name: paraphrase-multilingual
        path: /models/paraphrase-multilingual/model.onnx
      top-k: 20                      # æ£€ç´¢æ•°é‡
      similarity-threshold: 0.4       # ç›¸ä¼¼åº¦é˜ˆå€¼
```

**ä¸¤ç§æ£€ç´¢æ¨¡å¼å¯¹æ¯”**:

| ç‰¹æ€§ | å…³é”®è¯æ£€ç´¢ï¼ˆBM25ï¼‰ | å‘é‡æ£€ç´¢ï¼ˆè¯­ä¹‰ï¼‰ |
|------|------------------|----------------|
| **é…ç½®** | âœ… é›¶é…ç½® | âš ï¸ éœ€ä¸‹è½½ 420MB æ¨¡å‹ |
| **å†…å­˜** | âœ… 256MB - 1GB | âš ï¸ 1GB - 4GB |
| **é€Ÿåº¦** | âœ… æå¿«ï¼ˆ<50msï¼‰ | âš ï¸ è¾ƒå¿«ï¼ˆ<100msï¼‰ |
| **ç²¾ç¡®åŒ¹é…** | âœ… ä¼˜ç§€ | â­ è‰¯å¥½ |
| **è¯­ä¹‰ç†è§£** | â­ åŸºç¡€ | âœ… ä¼˜ç§€ |
| **é€‚ç”¨åœºæ™¯** | ç²¾ç¡®å…³é”®è¯æŸ¥è¯¢ | æ¨¡ç³Šè¯­ä¹‰æŸ¥è¯¢ |

#### 4. é…ç½®çœŸå® LLMï¼ˆAI é—®ç­”ï¼‰

**OpenAI GPT-4**:
```yaml
knowledge:
  qa:
    llm:
      provider: openai
      api-key: sk-your-openai-key
      model: gpt-4o
      endpoint: https://api.openai.com/v1/chat/completions
      temperature: 0.7
```

**DeepSeekï¼ˆå›½äº§ï¼‰**:
```yaml
knowledge:
  qa:
    llm:
      provider: deepseek
      api-key: sk-your-deepseek-key
      model: deepseek-chat
      endpoint: https://api.deepseek.com/v1/chat/completions
```

**ä½¿ç”¨ç¯å¢ƒå˜é‡ï¼ˆæ¨èï¼‰**:
```bash
# Windows
set AI_API_KEY=sk-your-api-key
start.bat

# Linux/Mac
export AI_API_KEY=sk-your-api-key
./start.sh
```

#### 5. OCR é…ç½®

é»˜è®¤å·²å¯ç”¨ï¼Œä¸‹è½½è¯­è¨€åŒ…åå³å¯ä½¿ç”¨ï¼š

```yaml
# å·²å†…ç½®é…ç½®ï¼Œæ— éœ€ä¿®æ”¹
knowledge:
  qa:
    ocr:
      provider: tesseract  # ä½¿ç”¨ Tesseract OCR
      tesseract:
        data-path: ./tessdata
        language: chi_sim+eng  # ä¸­è‹±æ–‡
```

#### 6. å†…å­˜å’Œæ€§èƒ½è°ƒä¼˜

ç¼–è¾‘ `start.bat`ï¼š

```batch
# å¼€å‘ç¯å¢ƒï¼ˆ2-4GBï¼‰
set JAVA_OPTS=-Xms512m -Xmx2g

# ç”Ÿäº§ç¯å¢ƒï¼ˆ4-8GBï¼Œæ¨èï¼‰
set JAVA_OPTS=-Xms1g -Xmx4g
set JAVA_OPTS=%JAVA_OPTS% -XX:+UseG1GC
set JAVA_OPTS=%JAVA_OPTS% -XX:MaxGCPauseMillis=200
```

---

## ğŸ¬ é¦–æ¬¡å¯åŠ¨æµç¨‹

### 1. å¯åŠ¨åº”ç”¨

```bash
# Windows
start.bat

# Linux/Mac
./start.sh
```

### 2. è§‚å¯Ÿå¯åŠ¨æ—¥å¿—

åº”çœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼ˆçº¦ 10-30 ç§’ï¼‰ï¼š

```
================================================================================
ğŸ“š AI Reviewer Base File RAG - çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿ
================================================================================
ç‰ˆæœ¬: 1.0
ç«¯å£: 8080
æ–‡æ¡£è·¯å¾„: ./data/documents
================================================================================

ğŸ” æ‰«ææ–‡æ¡£ç›®å½•...
   âœ“ æ‰¾åˆ° 150 ä¸ªæ–‡æ¡£æ–‡ä»¶

ğŸ“ å¼€å§‹ç´¢å¼•æ–‡æ¡£...
   [1/150] äº§å“æ‰‹å†Œ.pdf (2.5 MB)
      âœ“ æå– 15,234 å­—ç¬¦
      âœ“ OCR è¯†åˆ« 3 å¼ å›¾ç‰‡
      âœ“ ç´¢å¼•å®Œæˆ

   [2/150] æŠ€æœ¯æ–‡æ¡£.docx (1.2 MB)
      âœ“ æå– 8,567 å­—ç¬¦
      âœ“ ç´¢å¼•å®Œæˆ

   ... (ç»§ç»­å¤„ç†)

================================================================================
âœ… çŸ¥è¯†åº“æ„å»ºå®Œæˆ
================================================================================
   ğŸ“Š ç»Ÿè®¡ä¿¡æ¯:
      - æˆåŠŸ: 148 ä¸ªæ–‡ä»¶
      - å¤±è´¥: 2 ä¸ªæ–‡ä»¶
      - æ€»æ–‡æ¡£: 148 ä¸ª
      - æ€»å­—ç¬¦: 1,234,567
      - è€—æ—¶: 32.5 ç§’
================================================================================

ğŸš€ åº”ç”¨å¯åŠ¨æˆåŠŸï¼
   è®¿é—®åœ°å€: http://localhost:8080
   API æ–‡æ¡£: http://localhost:8080/swagger-ui.html (å¦‚å¯ç”¨)
   å¥åº·æ£€æŸ¥: http://localhost:8080/api/qa/health
================================================================================
```

### 3. éªŒè¯è¿è¡ŒçŠ¶æ€

```bash
# å¥åº·æ£€æŸ¥
curl http://localhost:8080/api/qa/health

# æŸ¥çœ‹ç»Ÿè®¡
curl http://localhost:8080/api/qa/statistics

# ç®€å•æœç´¢
curl "http://localhost:8080/api/qa/search?query=æµ‹è¯•&limit=3"
```

---

## ğŸ“¡ API ä½¿ç”¨æŒ‡å—

### åŸºç¡€ URL

```
http://localhost:8080
```

### 1. å¥åº·æ£€æŸ¥

```http
GET /api/qa/health
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "status": "UP",
  "message": "çŸ¥è¯†åº“é—®ç­”ç³»ç»Ÿè¿è¡Œæ­£å¸¸",
  "timestamp": "2025-11-25T10:30:00"
}
```

### 2. è·å–ç»Ÿè®¡ä¿¡æ¯

```http
GET /api/qa/statistics
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "documentCount": 148,
  "indexedDocumentCount": 148,
  "totalSize": "125.5 MB",
  "indexPath": "./data/knowledge-base",
  "lastUpdated": "2025-11-25T10:25:00",
  "vectorSearchEnabled": false
}
```

### 3. æœç´¢æ–‡æ¡£

```http
GET /api/qa/search?query={å…³é”®è¯}&limit={æ•°é‡}
```

**å‚æ•°è¯´æ˜**:
| å‚æ•° | ç±»å‹ | å¿…éœ€ | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|------|------|--------|
| `query` | String | âœ… | æœç´¢å…³é”®è¯ | - |
| `limit` | Integer | âŒ | è¿”å›æ•°é‡ | 10 |

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl "http://localhost:8080/api/qa/search?query=äº§å“ç‰¹æ€§&limit=5"
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "query": "äº§å“ç‰¹æ€§",
  "total": 15,
  "documents": [
    {
      "id": "doc-20251125-001",
      "title": "äº§å“æ‰‹å†Œ.pdf",
      "content": "äº§å“ä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼šé«˜æ€§èƒ½ã€æ˜“ç”¨æ€§ã€å®‰å…¨æ€§...",
      "score": 0.92,
      "metadata": {
        "fileName": "äº§å“æ‰‹å†Œ.pdf",
        "fileSize": "2.5 MB",
        "indexedAt": "2025-11-25T10:25:00"
      }
    }
  ]
}
```

### 4. æ™ºèƒ½é—®ç­”ï¼ˆéœ€é…ç½® LLMï¼‰

```http
POST /api/qa/ask
Content-Type: application/json
```

**è¯·æ±‚ä½“**:
```json
{
  "question": "äº§å“æœ‰å“ªäº›ä¸»è¦ç‰¹æ€§ï¼Ÿ",
  "topK": 5  // å¯é€‰ï¼Œæ£€ç´¢æ–‡æ¡£æ•°é‡
}
```

**è¯·æ±‚ç¤ºä¾‹**:
```bash
curl -X POST http://localhost:8080/api/qa/ask \
  -H "Content-Type: application/json" \
  -d '{
    "question": "äº§å“æœ‰å“ªäº›ä¸»è¦ç‰¹æ€§ï¼Ÿ"
  }'
```

**å“åº”ç¤ºä¾‹**:
```json
{
  "question": "äº§å“æœ‰å“ªäº›ä¸»è¦ç‰¹æ€§ï¼Ÿ",
  "answer": "æ ¹æ®äº§å“æ–‡æ¡£ï¼Œä¸»è¦ç‰¹æ€§åŒ…æ‹¬ï¼š\n1. é«˜æ€§èƒ½ï¼šé‡‡ç”¨...\n2. æ˜“ç”¨æ€§ï¼šæä¾›...\n3. å®‰å…¨æ€§ï¼šæ”¯æŒ...",
  "sources": [
    {
      "fileName": "äº§å“æ‰‹å†Œ.pdf",
      "content": "äº§å“ä¸»è¦ç‰¹æ€§åŒ…æ‹¬...",
      "score": 0.92
    }
  ],
  "confidence": 0.89,
  "responseTimeMs": 1250
}
```

### 5. é‡å»ºçŸ¥è¯†åº“

```http
POST /api/qa/rebuild
```

**è¯´æ˜**: åˆ é™¤ç°æœ‰ç´¢å¼•å¹¶é‡æ–°ç´¢å¼•æ‰€æœ‰æ–‡æ¡£

**å“åº”ç¤ºä¾‹**:
```json
{
  "status": "success",
  "message": "çŸ¥è¯†åº“é‡å»ºå®Œæˆ",
  "documentsProcessed": 148,
  "timeElapsedSeconds": 32.5
}
```

### API é”™è¯¯å¤„ç†

**é”™è¯¯å“åº”æ ¼å¼**:
```json
{
  "error": "Bad Request",
  "message": "query å‚æ•°ä¸èƒ½ä¸ºç©º",
  "timestamp": "2025-11-25T10:30:00",
  "path": "/api/qa/search"
}
```

**å¸¸è§é”™è¯¯ç **:
| çŠ¶æ€ç  | è¯´æ˜ |
|--------|------|
| 200 | æˆåŠŸ |
| 400 | è¯·æ±‚å‚æ•°é”™è¯¯ |
| 404 | èµ„æºä¸å­˜åœ¨ |
| 500 | æœåŠ¡å™¨å†…éƒ¨é”™è¯¯ |
| 503 | æœåŠ¡ä¸å¯ç”¨ï¼ˆå¯åŠ¨ä¸­ï¼‰|

---

## â“ å¸¸è§é—®é¢˜

### Q1: ç«¯å£ 8080 å·²è¢«å ç”¨æ€ä¹ˆåŠï¼Ÿ

**é”™è¯¯ä¿¡æ¯**:
```
Port 8080 is already in use
```

**è§£å†³æ–¹æ¡ˆ**:

**æ–¹æ³• 1: ä¿®æ”¹ç«¯å£**ï¼ˆæ¨èï¼‰
```yaml
# ç¼–è¾‘ config/application.yml
server:
  port: 9090  # æ”¹ä¸ºå…¶ä»–ç«¯å£
```

**æ–¹æ³• 2: åœæ­¢å ç”¨ç«¯å£çš„ç¨‹åº**
```bash
# æŸ¥æ‰¾å ç”¨ç«¯å£çš„è¿›ç¨‹
netstat -ano | findstr :8080

# ç»“æŸè¿›ç¨‹
taskkill /PID <è¿›ç¨‹ID> /F
```

---

### Q2: æ‰¾ä¸åˆ°æ–‡æ¡£æˆ–æ–‡æ¡£æœªè¢«ç´¢å¼•

**å¯èƒ½åŸå› **:
1. âŒ æ–‡æ¡£æ”¾é”™ä½ç½®
2. âŒ æ–‡ä»¶æ ¼å¼ä¸æ”¯æŒ
3. âŒ é…ç½®è·¯å¾„é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:

**æ£€æŸ¥æ¸…å•**:
- [ ] æ–‡æ¡£æ˜¯å¦åœ¨ `data/documents/` ç›®å½•
- [ ] æ–‡ä»¶æ ¼å¼æ˜¯å¦åœ¨æ”¯æŒåˆ—è¡¨ä¸­ï¼ˆPDF/DOCX/XLSX/TXT ç­‰ï¼‰
- [ ] æ£€æŸ¥ `config/application.yml` ä¸­çš„ `source-path` é…ç½®

**éªŒè¯é…ç½®**:
```yaml
knowledge:
  qa:
    knowledge-base:
      source-path: ./data/documents  # ç¡®è®¤è·¯å¾„æ­£ç¡®
```

---

### Q3: å†…å­˜ä¸è¶³ï¼ˆOutOfMemoryErrorï¼‰

**é”™è¯¯ä¿¡æ¯**:
```
Java heap space
OutOfMemoryError: Java heap space
```

**è§£å†³æ–¹æ¡ˆ**:

**å¢åŠ  JVM å†…å­˜**:

ç¼–è¾‘ `start.bat`ï¼š
```batch
# å°†æœ€å¤§å†…å­˜ä» 2g å¢åŠ åˆ° 4g æˆ–æ›´é«˜
set JAVA_OPTS=-Xms1g -Xmx4g
```

**å†…å­˜å»ºè®®**:
| æ–‡æ¡£æ•°é‡ | æ¨èå†…å­˜ |
|---------|---------|
| < 1,000 | 2GB |
| 1,000 - 10,000 | 4GB |
| > 10,000 | 8GB+ |

---

### Q4: ä¸­æ–‡æ˜¾ç¤ºä¹±ç 

**é—®é¢˜è¡¨ç°**:
- æ—¥å¿—ä¸­ä¸­æ–‡æ˜¾ç¤ºä¸ºä¹±ç 
- æœç´¢ç»“æœä¸­æ–‡é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:

**1. ç¡®è®¤é…ç½®æ–‡ä»¶ç¼–ç **:
- `config/application.yml` å¿…é¡»ä½¿ç”¨ **UTF-8 ç¼–ç **ä¿å­˜

**2. è®¾ç½®æ§åˆ¶å°ç¼–ç **:
```batch
# start.bat ä¸­å·²åŒ…å«æ­¤è®¾ç½®
chcp 65001
```

**3. æ£€æŸ¥æ–‡æ¡£ç¼–ç **:
- ç¡®ä¿æ–‡æ¡£æœ¬èº«ä½¿ç”¨ UTF-8 æˆ–ç³»ç»Ÿé»˜è®¤ç¼–ç 

---

### Q5: OCR ä¸å·¥ä½œæˆ–å›¾ç‰‡æ— æ³•è¯†åˆ«

**é—®é¢˜è¡¨ç°**:
- æ—¥å¿—æ˜¾ç¤º "Tesseract ä¸å¯ç”¨"
- å›¾ç‰‡ä¸­çš„æ–‡å­—æœªè¢«æå–

**è§£å†³æ–¹æ¡ˆ**:

**å¿«é€Ÿè¯Šæ–­**:
```bash
# è¿è¡Œè¯Šæ–­å·¥å…·
check-ocr.bat
```

**å¸¸è§é—®é¢˜**:

1. **æœªä¸‹è½½è¯­è¨€åŒ…**:
   ```bash
   # ä¸‹è½½è¯­è¨€åŒ…
   download-tessdata.bat
   ```

2. **è¯­è¨€åŒ…è·¯å¾„é”™è¯¯**:
   ```yaml
   # æ£€æŸ¥ config/application.yml
   knowledge:
     qa:
       ocr:
         tesseract:
           data-path: ./tessdata  # ç¡®è®¤è·¯å¾„æ­£ç¡®
   ```

3. **è¯¦ç»†æ’æŸ¥**:
   - æŸ¥çœ‹ [OCRè¯Šæ–­æŒ‡å—.md](OCRè¯Šæ–­æŒ‡å—.md)

---

### Q6: å‘é‡æ£€ç´¢åˆå§‹åŒ–å¤±è´¥

**é”™è¯¯ä¿¡æ¯**:
```
å‘é‡æ£€ç´¢å¼•æ“åˆå§‹åŒ–å¤±è´¥
æ¨¡å‹æ–‡ä»¶æœªæ‰¾åˆ°
```

**è§£å†³æ–¹æ¡ˆ**:

**æ–¹æ³• 1: ç¦ç”¨å‘é‡æ£€ç´¢**ï¼ˆæ¨èï¼Œå¦‚ä¸éœ€è¦è¯­ä¹‰æœç´¢ï¼‰
```yaml
# config/application.yml
knowledge:
  qa:
    vector-search:
      enabled: false  # ä½¿ç”¨å…³é”®è¯æ£€ç´¢å³å¯
```

**æ–¹æ³• 2: ä¸‹è½½æ¨¡å‹**ï¼ˆå¦‚éœ€è¦è¯­ä¹‰æœç´¢ï¼‰
```bash
# è¿›å…¥ models ç›®å½•
cd models

# è¿è¡Œä¸‹è½½è„šæœ¬
download model.bat

# ç­‰å¾…ä¸‹è½½å®Œæˆï¼ˆçº¦ 420MBï¼‰
```

è¯¦ç»†è¯´æ˜: [æ¨¡å‹ä¸‹è½½è¯´æ˜.md](æ¨¡å‹ä¸‹è½½è¯´æ˜.md)

---

### Q7: ç´¢å¼•é”å®šé”™è¯¯ï¼ˆLockObtainFailedExceptionï¼‰

**é”™è¯¯ä¿¡æ¯**:
```
LockObtainFailedException: Lock held by this virtual machine
```

**åŸå› **: ä¸Šæ¬¡åº”ç”¨æœªæ­£å¸¸å…³é—­ï¼Œç•™ä¸‹é”æ–‡ä»¶

**è§£å†³æ–¹æ¡ˆ**:

**æ–¹æ³• 1: ä½¿ç”¨ä¿®å¤è„šæœ¬**ï¼ˆæ¨èï¼‰
```bash
# è¿è¡Œä¿®å¤è„šæœ¬
fix-lock.bat
```

**æ–¹æ³• 2: æ‰‹åŠ¨åˆ é™¤é”æ–‡ä»¶**
```bash
# 1. åœæ­¢åº”ç”¨
stop.bat

# 2. åˆ é™¤é”æ–‡ä»¶
del data\knowledge-base\index\lucene-index\write.lock

# 3. é‡æ–°å¯åŠ¨
start.bat
```

**æ–¹æ³• 3: é‡å»ºç´¢å¼•**
```bash
stop.bat
rmdir /s /q data\knowledge-base
start.bat
```

**é¢„é˜²æªæ–½**:
- âœ… å§‹ç»ˆä½¿ç”¨ `stop.bat` æ­£å¸¸åœæ­¢
- âŒ ä¸è¦ç”¨ä»»åŠ¡ç®¡ç†å™¨å¼ºåˆ¶ç»“æŸ

è¯¦ç»†è¯´æ˜: [é”æ–‡ä»¶é—®é¢˜è§£å†³æŒ‡å—.md](é”æ–‡ä»¶é—®é¢˜è§£å†³æŒ‡å—.md)

---

### Q8: LLM API è°ƒç”¨å¤±è´¥

**é”™è¯¯ä¿¡æ¯**:
```
Failed to call LLM API
Invalid API Key
```

**è§£å†³æ–¹æ¡ˆ**:

**1. æ£€æŸ¥ API Key**:
```yaml
# config/application.yml
knowledge:
  qa:
    llm:
      api-key: sk-your-api-key  # ç¡®è®¤ Key æ­£ç¡®
```

**2. ä½¿ç”¨ç¯å¢ƒå˜é‡**ï¼ˆæ¨èï¼‰:
```bash
set AI_API_KEY=sk-your-api-key
start.bat
```

**3. æš‚æ—¶ä½¿ç”¨æ¨¡æ‹Ÿæ¨¡å¼**:
```yaml
knowledge:
  qa:
    llm:
      provider: mock  # ä¸è°ƒç”¨çœŸå® LLM
```

---

### Q9: æ–‡æ¡£æ•°é‡å¾ˆå¤šï¼Œå¯åŠ¨å¾ˆæ…¢

**é—®é¢˜**: é¦–æ¬¡å¯åŠ¨éœ€è¦ç´¢å¼•å¤§é‡æ–‡æ¡£

**ä¼˜åŒ–æ–¹æ¡ˆ**:

**1. å¢é‡ç´¢å¼•**ï¼ˆæ¨èï¼‰:
```yaml
knowledge:
  qa:
    knowledge-base:
      rebuild-on-startup: false  # åªç´¢å¼•æ–°æ–‡æ¡£
```

**2. è°ƒæ•´å¹¶å‘**:
```yaml
knowledge:
  qa:
    document:
      parallel-processing: true  # å¯ç”¨å¹¶è¡Œå¤„ç†
```

**3. åˆ†æ‰¹å¤„ç†**:
- å…ˆç´¢å¼•é‡è¦æ–‡æ¡£
- å…¶ä»–æ–‡æ¡£åç»­æ·»åŠ 

---

### Q10: æœç´¢ç»“æœä¸å‡†ç¡®

**ä¼˜åŒ–å»ºè®®**:

**1. è°ƒæ•´æ£€ç´¢æ•°é‡**:
```yaml
knowledge:
  qa:
    vector-search:
      top-k: 20  # å¢åŠ å€™é€‰æ•°é‡
```

**2. è°ƒæ•´ç›¸ä¼¼åº¦é˜ˆå€¼**:
```yaml
knowledge:
  qa:
    vector-search:
      similarity-threshold: 0.3  # é™ä½é˜ˆå€¼
```

**3. å¯ç”¨å‘é‡æ£€ç´¢**:
- å‘é‡æ£€ç´¢åœ¨è¯­ä¹‰ç†è§£ä¸Šæ›´å‡†ç¡®
- å‚è€ƒ Q6 ä¸‹è½½æ¨¡å‹

**4. ä¼˜åŒ–æ–‡æ¡£è´¨é‡**:
- ä½¿ç”¨æ¸…æ™°çš„æ–‡æ¡£æ ‡é¢˜
- é¿å…è¿‡é•¿çš„æ–‡æ¡£ï¼ˆå»ºè®®åˆ†æ®µï¼‰
- å®šæœŸæ¸…ç†è¿‡æ—¶æ–‡æ¡£

---

## ğŸ“ æ•°æ®ç®¡ç†

### é‡å»ºçŸ¥è¯†åº“

**åœºæ™¯**: æ–‡æ¡£æœ‰æ›´æ–°ã€ç´¢å¼•æŸåã€éœ€è¦å®Œå…¨é‡å»º

**æ–¹æ³• 1: é…ç½®é‡å»º**
```yaml
# config/application.yml
knowledge:
  qa:
    knowledge-base:
      rebuild-on-startup: true  # å¯åŠ¨æ—¶é‡å»º
```

ç„¶åé‡å¯åº”ç”¨ï¼Œå®Œæˆåæ”¹å› `false`ã€‚

**æ–¹æ³• 2: åˆ é™¤ç´¢å¼•é‡å»º**
```bash
stop.bat
rmdir /s /q data\knowledge-base
rmdir /s /q data\vector-index
start.bat
```

**æ–¹æ³• 3: API é‡å»º**
```bash
curl -X POST http://localhost:8080/api/qa/rebuild
```

### æ•°æ®å¤‡ä»½

**å®šæœŸå¤‡ä»½ä»¥ä¸‹å†…å®¹**:

| å†…å®¹ | è·¯å¾„ | é‡è¦æ€§ |
|------|------|--------|
| çŸ¥è¯†åº“ç´¢å¼• | `data/knowledge-base/` | â­â­â­ |
| å‘é‡ç´¢å¼• | `data/vector-index/` | â­â­ |
| é…ç½®æ–‡ä»¶ | `config/application.yml` | â­â­â­ |
| åŸå§‹æ–‡æ¡£ | `data/documents/` | â­â­â­ |

**å¤‡ä»½å‘½ä»¤**:
```bash
# åˆ›å»ºå¤‡ä»½
tar -czf backup-$(date +%Y%m%d).tar.gz data/ config/

# æˆ–ä½¿ç”¨ PowerShell
Compress-Archive -Path data,config -DestinationPath backup-$(Get-Date -Format yyyyMMdd).zip
```

### æ—¥å¿—ç®¡ç†

**æ—¥å¿—ä½ç½®**: `logs/ai-reviewer-rag.log`

**æ¸…ç†æ—§æ—¥å¿—**:
```bash
# åˆ é™¤æ‰€æœ‰æ—¥å¿—
del logs\*.log

# åªä¿ç•™æœ€è¿‘ 7 å¤©
forfiles /p logs /s /m *.log /d -7 /c "cmd /c del @path"
```

**æ—¥å¿—çº§åˆ«é…ç½®**:
```yaml
# config/application.yml
logging:
  level:
    top.yumbo.ai.rag: INFO  # DEBUG/INFO/WARN/ERROR
```

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### JVM å‚æ•°ä¼˜åŒ–

ç¼–è¾‘ `start.bat`ï¼Œæ ¹æ®ç¯å¢ƒè°ƒæ•´ï¼š

```batch
:: å¼€å‘ç¯å¢ƒï¼ˆ2-4GBï¼‰
set JAVA_OPTS=-Xms512m -Xmx2g

:: ç”Ÿäº§ç¯å¢ƒï¼ˆ4-8GBï¼Œæ¨èï¼‰
set JAVA_OPTS=-Xms1g -Xmx4g
set JAVA_OPTS=%JAVA_OPTS% -XX:+UseG1GC
set JAVA_OPTS=%JAVA_OPTS% -XX:MaxGCPauseMillis=200
set JAVA_OPTS=%JAVA_OPTS% -XX:+HeapDumpOnOutOfMemoryError
set JAVA_OPTS=%JAVA_OPTS% -XX:HeapDumpPath=./logs/heap-dump.hprof
```

### ç´¢å¼•æ€§èƒ½ä¼˜åŒ–

```yaml
knowledge:
  qa:
    knowledge-base:
      enable-cache: true  # å¯ç”¨ç¼“å­˜ï¼Œæå‡æŸ¥è¯¢é€Ÿåº¦
      
    document:
      chunk-size: 2000     # æ–‡æ¡£åˆ†å—å¤§å°
      chunk-overlap: 400   # åˆ†å—é‡å å¤§å°
      parallel-processing: true  # å¹¶è¡Œå¤„ç†
```

### æ£€ç´¢æ€§èƒ½ä¼˜åŒ–

```yaml
knowledge:
  qa:
    vector-search:
      top-k: 20                    # å¢åŠ æ£€ç´¢æ•°é‡
      similarity-threshold: 0.4    # è°ƒæ•´ç›¸ä¼¼åº¦é˜ˆå€¼
      use-cache: true              # å¯ç”¨æ£€ç´¢ç¼“å­˜
```

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

### è·å–å¸®åŠ©

1. **æŸ¥çœ‹æ–‡æ¡£**:
   - [å¿«é€Ÿå¯åŠ¨-OCR.md](å¿«é€Ÿå¯åŠ¨-OCR.md) - OCR å¿«é€ŸæŒ‡å—
   - [æ¨¡å‹ä¸‹è½½è¯´æ˜.md](æ¨¡å‹ä¸‹è½½è¯´æ˜.md) - å‘é‡æ¨¡å‹ä¸‹è½½
   - [é”æ–‡ä»¶é—®é¢˜è§£å†³æŒ‡å—.md](é”æ–‡ä»¶é—®é¢˜è§£å†³æŒ‡å—.md) - ç´¢å¼•é”é—®é¢˜

2. **è¿è¡Œè¯Šæ–­å·¥å…·**:
   ```bash
   check-ocr.bat  # OCR é…ç½®æ£€æŸ¥
   ```

3. **æŸ¥çœ‹æ—¥å¿—**:
   ```bash
   # æŸ¥çœ‹æœ€æ–°æ—¥å¿—
   tail -f logs/ai-reviewer-rag.log
   
   # Windows
   Get-Content logs\ai-reviewer-rag.log -Tail 50
   ```

4. **é—®é¢˜åé¦ˆ**:
   - GitHub Issues: [æäº¤é—®é¢˜](https://github.com/jinhua10/ai-reviewer-base-file-rag/issues)
   - Email: 1015770492@qq.com

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0.0 (2025-11-25)

#### ğŸ†• æ–°å¢ç‰¹æ€§
- âœ… æ”¯æŒ 35+ æ–‡æ¡£æ ¼å¼ï¼ˆPDF, DOCX, XLSX, PPTX, TXT, MD ç­‰ï¼‰
- âœ… OCR å›¾ç‰‡æ–‡å­—è¯†åˆ«ï¼ˆTesseractï¼‰
- âœ… BM25 å…³é”®è¯æ£€ç´¢ï¼ˆé›¶é…ç½®ï¼‰
- âœ… å‘é‡è¯­ä¹‰æ£€ç´¢ï¼ˆå¯é€‰ï¼‰
- âœ… å¤š LLM æ”¯æŒï¼ˆOpenAI, DeepSeek, Claudeï¼‰
- âœ… REST API æ¥å£
- âœ… å¤–ç½®é…ç½®æ”¯æŒ

#### ğŸ”§ ä¿®å¤
- âœ… PDFBox å…¼å®¹æ€§é—®é¢˜
- âœ… ä¸­æ–‡ç¼–ç é—®é¢˜
- âœ… ç´¢å¼•é”å®šé—®é¢˜

#### ğŸ“– æ–‡æ¡£
- âœ… å®Œæ•´çš„éƒ¨ç½²æŒ‡å—
- âœ… OCR å¿«é€Ÿå¯åŠ¨æŒ‡å—
- âœ… é—®é¢˜è¯Šæ–­å·¥å…·

---

<div align="center">

## ğŸ‰ AI Reviewer Base File RAG v1.0

**ä¼ä¸šçº§æœ¬åœ°æ–‡ä»¶ RAG æ£€ç´¢ç³»ç»Ÿ**

Made with â¤ï¸ by AI Reviewer Team

[GitHub](https://github.com/jinhua10/ai-reviewer-base-file-rag) | [æ–‡æ¡£](../README.md) | [é—®é¢˜åé¦ˆ](https://github.com/jinhua10/ai-reviewer-base-file-rag/issues)

</div>

